{"version":3,"sources":["timer.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"timer.js","sourcesContent":["jQuery(document).ready(function($){\n\n    // Set headers for AJAX\n    $.ajaxSetup({\n        headers: {\n            'X-CSRF-TOKEN': $('meta[name=\"csrf_token\"]').attr('content')\n        }\n    });\n\n    // Start the timer\n    timelimit = 0;\n    now = 0;\n    getTimeLimit(1);\n});\n\n// Get time limit from server\nfunction getTimeLimit(init) {\n\n    var url = window.location.pathname+'/update_time';\n\n    $.ajax({\n        type: 'post',\n        url: url,\n        data: {},\n        dataType: 'json',\n        success: function(data) {\n            timelimit = data * 1000;\n            now = Date.parse(new Date());\n\n            console.log('time limit synced: '+timelimit+' ms left');\n\n            if (init) initializeClock('countdown');\n        },\n        error: function(data) {\n            console.log(data.status+' '+data.statusText);\n            $('html').prepend(data.responseText);\n        }\n    });\n}\n\n// Initialize clock\nfunction initializeClock(id) {\n    var clock = document.getElementById(id);\n    var time = clock.querySelector('.time');\n    var times_up = false;\n\n    function updateClock() {\n        if (! times_up) {\n            var t = getTimeRemaining();\n            time.innerHTML = ('0' + t.minutes).slice(-2) + ':' + ('0' + t.seconds).slice(-2);\n            console.log(t.days+':'+ t.hours+':'+ t.minutes+':'+ t.seconds);\n\n            if (t.total <= 0) {\n                clearInterval(timeinterval);\n                time.innerHTML = '00:00';\n                clearInterval(synctime);\n                timeEnded();\n                times_up = true;\n            }\n        }\n    }\n\n    updateClock();\n    var timeinterval = setInterval(updateClock, 1000);\n    var synctime = setInterval(getTimeLimit, 1000 * 10);\n}\n\n// Get the time remaining until time limit is reached\nfunction getTimeRemaining() {\n    var t = (timelimit + now) - Date.parse(new Date());\n    var seconds = Math.floor((t / 1000) % 60);\n    var minutes = Math.floor((t / 1000 / 60) % 60);\n    var hours = Math.floor((t / (1000 * 60 * 60)) % 24);\n    var days = Math.floor(t / (1000 * 60 * 60 * 24));\n    return {\n        'total': t,\n        'days': days,\n        'hours': hours,\n        'minutes': minutes,\n        'seconds': seconds\n    };\n}\n\n// Time limit reached, time to submit the form\nfunction timeEnded() {\n    alert('Times Up!');\n\n    var data = {'complete': 1};\n    var url = window.location.pathname;\n\n    $.ajax({\n        type: 'post',\n        url: url,\n        data: data,\n        dataType: 'json',\n        success: function(data) {\n            console.log(data);\n            if (data['reload']) {\n                window.location.reload();\n            }\n        },\n        error: function(data) {\n            console.log(data.status+' '+data.statusText);\n            $('html').prepend(data.responseText);\n        }\n    });\n}"],"sourceRoot":"/source/"}