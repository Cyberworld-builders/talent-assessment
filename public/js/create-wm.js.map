{"version":3,"sources":["util.js","models.js","marked.js","sq.js","sy.js","task-template.js","create-task.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7pBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"create-wm.js","sourcesContent":["/**\n * Checks if the array of points contains a specific point.\n * @param array array<array>   An array of array which is a point.\n * @param point array<integer> An array containing two elements [x, y].\n * @return true if array contains the point.\n *         false if:\n *             array is null or undefined\n *             point is null or undefined\n *             array does not contain the point\n */\nfunction arrayHasPoint(array, point) {\n    if(!array || !point)\n        return false;\n\n    for(var i = 0; i < array.length; i++)\n        if(array[i] && array[i][0] == point[0] && array[i][1] == point[1])\n            return true;\n    return false;\n}\n\n/**\n * Shuffles an array in place.\n *\n * @param array The array to be shuffled.\n * @returns the array itself.\n */\nfunction shuffle(array) {\n    var currentIndex = array.length, temporaryValue, randomIndex;\n\n    // While there remain elements to shuffle...\n    while (0 !== currentIndex) {\n\n      // Pick a remaining element...\n      randomIndex = Math.floor(Math.random() * currentIndex);\n      currentIndex -= 1;\n\n      // And swap it with the current element.\n      temporaryValue = array[currentIndex];\n      array[currentIndex] = array[randomIndex];\n      array[randomIndex] = temporaryValue;\n    }\n\n    return array;\n}\n\n/**\n * Trim null from the end of array, in place.\n *\n * @param array The array to be trimmed.\n * @returns the array itself.\n */\nfunction trimArray(array) {\n    var p = 0;\n    for(var i = 0; i < array.length; i++) {\n        if(array[i] == null) {\n            p = i;\n            break;\n        }\n    }\n    var res = array.splice(0, p);\n    return res;\n}\n\n/**\n * No operation\n */\nfunction nop() {}\n\nvar PointCollection = {\n    indexOf: function(pointArray, point) {\n        for(var i = 0; i < pointArray.length; i++)\n            if(pointArray[i] && pointArray[i][0] == point[0] && pointArray[i][0] == point[0] && pointArray[i][1] == point[1])\n                return i;\n        return -1;\n    }\n};\n\nString.prototype.capitalize = function() {\n    return this.charAt(0).toUpperCase() + this.slice(1);\n}","var EQ = {\n    typeId: 'eq',\n    typeLabel: 'Equation',\n    getAnswer: function(equation) {\n        var p = equation.indexOf('=');\n        return eval(equation.substring(0, p)) == equation.substring(p + 1);\n    },\n    isValid: function(equation) {\n        return /^[()0-9+\\-*\\/]+=\\d+$/.test(equation);\n    },\n    getScore: function(equation, response) {\n        if(this.getAnswer(equation) === response)\n            return 1;\n        return 0;\n    }\n};\n\nvar TEXT = {\n    typeId: 'input',\n    typeLabel: 'Text Input',\n};\n\nvar LS = {\n    typeId: 'ls',\n    typeLabel: 'Letter Sequence',\n    /**\n     * Make a random array of letters (options), including the specified letter array, to be used for recall.\n     *\n     * @param letters array A list of letters to include. This is usually the original list of letters shown to participant.\n     */\n    makeOptions: function(letters) {\n        var res = letters.slice(), a = 'A'.charCodeAt(0), z = 'Z'.charCodeAt(0);\n\n        while(res.length < 12) {\n            //Get a random letter\n            var c = Math.floor(Math.random() * (z - a)) + a;\n            var l = String.fromCharCode(c);\n            \n            if(l != 'A' && l != 'E' && l != 'I' && l != 'O' && l != 'U' && res.indexOf(l) == -1)\n                res.push(l);\n        }\n\n        res = shuffle(res);\n        return res;\n    },\n    makeRandomLetterArray: function(length) {\n        var res = [], a = 'A'.charCodeAt(0), z = 'Z'.charCodeAt(0);\n\n        while(res.length < length) {\n            //Get a random letter\n            var c = Math.floor(Math.random() * (z - a)) + a;\n            var l = String.fromCharCode(c);\n            if(l != 'A' && l != 'E' && l != 'I' && l != 'O' && l != 'U' && res.indexOf(l) == -1)\n                res.push(l);\n        }\n        \n        return res;\n    },\n    getScore: function(letters, response) {\n        var sum = 0;\n        for(var i = 0; i < letters.length; i++)\n            if(letters[i] === response[i])\n                sum++;\n        return sum;\n    }\n};\n\nvar EQLS = {\n    typeId: 'eqls',\n    typeLabel: 'Equation Letters'\n};\n\nvar SQ = {\n    typeId: 'sq',\n    typeLabel: 'Square Sequence',\n    /**\n     * @param length How many squares are to be in the generated sequence.\n     * @returns An array of arrays, where each array represent a point [x, y].\n     */\n    makeRandomFigure: function(length) {\n        var res = [];\n        while(res.length < length) {\n            var x = Math.floor(Math.random() * 4);\n            var y = Math.floor(Math.random() * 4);\n            var p = [x, y];\n            if(!arrayHasPoint(res, p))\n                res.push(p);\n        }\n        return res;\n    },\n    getScore: function(squares, response) {\n        var sum = 0;\n        for(var i = 0; i < squares.length; i++)\n            if(response[i] && squares[i][0] === response[i][0] && squares[i][1] === response[i][1])\n                sum++;\n        return sum;\n    }\n};\n\nvar SY = {\n    typeId: 'sy',\n    typeLabel: 'Symmetry',\n    getRandomPoint: function(array) {\n        var p = [0, 0];\n        do {\n            p[0] = Math.floor(Math.random() * 8);\n            p[1] = Math.floor(Math.random() * 8);\n        } while(arrayHasPoint(array, p));\n        return p;\n    },\n    /**\n     * Generate a random symmetric figure.\n     * @param density integer how many cells are colored. This should be a 0 >= density <= 30.\n     */\n    makeSymmetricFigure: function(density) {\n        if(!density || density < 0 || density > 30)\n            density = Math.floor(Math.random() * 18) + 12;\n\n        var points = [];\n\n        while(points.length < density * 2) {\n            var x = Math.floor(Math.random() * 4);\n            var y = Math.floor(Math.random() * 8);\n            var p = [x, y];\n\n            if(!arrayHasPoint(points, p)) {\n                points.push(p);\n                points.push(this.getMirror(p));\n            }\n        }\n\n        return points;\n    },\n    /**\n     * Generate a asymmetric figure by mutating a random symmetric figure.\n     * @param density integer how many cells are colored. This should be a 0 >= density <= 30.\n     */\n    makeAsymmetricFigure: function(density) {\n        var points = this.makeSymmetricFigure(density);\n\n        for(var i = 0; i < 3; i++) {\n            var op = Math.floor(Math.random() * (i == 0 ? 2 : 3));\n            switch(op) {\n                case 0:\n                    points.push(this.getRandomPoint(points));\n                    break;\n                case 1:\n                    var index = Math.floor(Math.random() * points.length);\n                    points.splice(index, 1);\n                    break;\n            }\n        }\n\n        return points;\n    },\n    /**\n     * Generate a totally random figure.\n     * @param density integer how many cells are colored. This should be a 0 >= density <= 30.\n     */\n    makeRandomFigure: function(density) {\n        if(!density || density < 0 || density > 30)\n            density = Math.floor(Math.random() * 18) + 12;\n\n        var points = [];\n        while(points.length < density * 2) {\n            points.push(this.getRandomPoint(points));\n        }\n        return points;\n    },\n    makeFigure: function() {\n        var density = Math.floor(Math.random() * 18) + 12; \n        switch(Math.floor(Math.random() * 5)) {\n            case 0:\n            case 1:\n                return this.makeSymmetricFigure(density);\n            case 2:\n            case 3:\n                return this.makeAsymmetricFigure(density);\n            case 4:\n                return this.makeRandomFigure(density);\n        }\n\n        return this.makeSymmetricFigure(density);\n    },\n    getMirror: function(p) {\n        return [7 - p[0], p[1]];\n    },\n    /**\n     * Checks a figure, represented by array, is symmetric.\n     * Throws if array is null or undefined.\n     */\n    isSymmetric: function(array) {\n        if(!array)\n            throw 'Figure array is undefined';\n\n        for(var i = 0; i < array.length; i++)\n            if(!arrayHasPoint(array, this.getMirror(array[i])))\n                return false;\n        return true;\n    },\n    getScore: function(symmetry, response) {\n        if(this.isSymmetric(symmetry) === response)\n            return 1;\n        return 0;\n    }\n};\n\nvar SYSQ = {\n    typeId: 'sysq',\n    typeLabel: 'Symmetry Squares',\n    /**\n     * Make a random computer generated problem.\n     * @param length integer The length of the sequence.\n     * @returns An object {type, squares, symmetries}\n     */\n    makeProblem: function(length) {\n        var squares = SQ.makeRandomFigure(length);\n        var symmetries = this.makeSymmetryFigures(length);\n        \n        return {type:this.typeId, squares:squares, symmetries:symmetries};\n    },\n    makeSymmetryFigures: function(length) {\n        var symmetries = [];\n\n        for(var i = 0; i < length; i++)\n            symmetries.push(SY.makeFigure());\n\n        return symmetries;\n    }\n};\n\nvar RS = {\n    typeId: 'rs',\n    typeLabel: 'Sentence'\n};\n\nvar RSLS = {\n    typeId: 'rsls',\n    typeLabel: 'Sentence Letters'\n};\n\nBLK = {\n    getScore: function(probBlock, respBlock) {\n        var sum = 0;\n        for(var i = 0; i < probBlock.problems.length; i++) {\n            var prob = probBlock.problems[i];\n            switch(prob.type) {\n                case LS.typeId: sum += LS.getScore(probBlock.problems[i].letters, respBlock[i].response); break;\n                case EQ.typeId: sum += EQ.getScore(probBlock.problems[i].equation, respBlock[i].response); break;\n                case SQ.typeId: sum += SQ.getScore(probBlock.problems[i].squares, respBlock[i].response); break;\n                case SY.typeId: sum += SY.getScore(probBlock.problems[i].symmetry, respBlock[i].response); break;\n                case EQLS.typeId: sum += LS.getScore(probBlock.problems[i].letters, respBlock[i].letters.response); break;\n                case SYSQ.typeId: sum += SQ.getScore(probBlock.problems[i].squares, respBlock[i].squares.response); break;\n            }\n        }\n        return sum;        \n    },\n    getMaxScore: function(block) {\n        var sum = 0;\n\n        for(var i = 0; i < block.problems.length; i++) {\n            var prob = block.problems[i];\n            switch(prob.type) {\n                case LS.typeId: sum += prob.letters.length; break;\n                case EQ.typeId: sum++; break;\n                case SQ.typeId: sum += prob.squares.length; break;\n                case SY.typeId: sum++; break;\n                case EQLS.typeId: sum += prob.letters.length; break;\n                case SYSQ.typeId: sum += prob.squares.length; break;\n            }\n        }\n\n        return sum;\n    }\n};\n\nTSK = {\n    getScore: function(task, respBlocks) {\n        var sum = 0;\n        for(var i = 0; i < task.blocks.length; i++)\n            if(!task.blocks[i].practice)\n                sum += BLK.getScore(task.blocks[i], respBlocks[i]);\n        return sum;\n    },\n    getMaxScore: function(task) {\n        var sum = 0;\n        for(var i = 0; i < task.blocks.length; i++)\n            if(!task.blocks[i].practice)\n                sum += BLK.getMaxScore(task.blocks[i]);\n        return sum;\n    }\n};","/**\n * marked - a markdown parser\n * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/chjj/marked\n */\n\n;(function() {\n\n/**\n * Block-Level Grammar\n */\n\nvar block = {\n  newline: /^\\n+/,\n  code: /^( {4}[^\\n]+\\n*)+/,\n  fences: noop,\n  hr: /^( *[-*_]){3,} *(?:\\n+|$)/,\n  heading: /^ *(#{1,6}) *([^\\n]+?) *#* *(?:\\n+|$)/,\n  nptable: noop,\n  lheading: /^([^\\n]+)\\n *(=|-){2,} *(?:\\n+|$)/,\n  blockquote: /^( *>[^\\n]+(\\n(?!def)[^\\n]+)*\\n*)+/,\n  list: /^( *)(bull) [\\s\\S]+?(?:hr|def|\\n{2,}(?! )(?!\\1bull )\\n*|\\s*$)/,\n  html: /^ *(?:comment *(?:\\n|\\s*$)|closed *(?:\\n{2,}|\\s*$)|closing *(?:\\n{2,}|\\s*$))/,\n  def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +[\"(]([^\\n]+)[\")])? *(?:\\n+|$)/,\n  table: noop,\n  paragraph: /^((?:[^\\n]+\\n?(?!hr|heading|lheading|blockquote|tag|def))+)\\n*/,\n  text: /^[^\\n]+/\n};\n\nblock.bullet = /(?:[*+-]|\\d+\\.)/;\nblock.item = /^( *)(bull) [^\\n]*(?:\\n(?!\\1bull )[^\\n]*)*/;\nblock.item = replace(block.item, 'gm')\n  (/bull/g, block.bullet)\n  ();\n\nblock.list = replace(block.list)\n  (/bull/g, block.bullet)\n  ('hr', '\\\\n+(?=\\\\1?(?:[-*_] *){3,}(?:\\\\n+|$))')\n  ('def', '\\\\n+(?=' + block.def.source + ')')\n  ();\n\nblock.blockquote = replace(block.blockquote)\n  ('def', block.def)\n  ();\n\nblock._tag = '(?!(?:'\n  + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code'\n  + '|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo'\n  + '|span|br|wbr|ins|del|img)\\\\b)\\\\w+(?!:/|[^\\\\w\\\\s@]*@)\\\\b';\n\nblock.html = replace(block.html)\n  ('comment', /<!--[\\s\\S]*?-->/)\n  ('closed', /<(tag)[\\s\\S]+?<\\/\\1>/)\n  ('closing', /<tag(?:\"[^\"]*\"|'[^']*'|[^'\">])*?>/)\n  (/tag/g, block._tag)\n  ();\n\nblock.paragraph = replace(block.paragraph)\n  ('hr', block.hr)\n  ('heading', block.heading)\n  ('lheading', block.lheading)\n  ('blockquote', block.blockquote)\n  ('tag', '<' + block._tag)\n  ('def', block.def)\n  ();\n\n/**\n * Normal Block Grammar\n */\n\nblock.normal = merge({}, block);\n\n/**\n * GFM Block Grammar\n */\n\nblock.gfm = merge({}, block.normal, {\n  fences: /^ *(`{3,}|~{3,})[ \\.]*(\\S+)? *\\n([\\s\\S]*?)\\s*\\1 *(?:\\n+|$)/,\n  paragraph: /^/,\n  heading: /^ *(#{1,6}) +([^\\n]+?) *#* *(?:\\n+|$)/\n});\n\nblock.gfm.paragraph = replace(block.paragraph)\n  ('(?!', '(?!'\n    + block.gfm.fences.source.replace('\\\\1', '\\\\2') + '|'\n    + block.list.source.replace('\\\\1', '\\\\3') + '|')\n  ();\n\n/**\n * GFM + Tables Block Grammar\n */\n\nblock.tables = merge({}, block.gfm, {\n  nptable: /^ *(\\S.*\\|.*)\\n *([-:]+ *\\|[-| :]*)\\n((?:.*\\|.*(?:\\n|$))*)\\n*/,\n  table: /^ *\\|(.+)\\n *\\|( *[-:]+[-| :]*)\\n((?: *\\|.*(?:\\n|$))*)\\n*/\n});\n\n/**\n * Block Lexer\n */\n\nfunction Lexer(options) {\n  this.tokens = [];\n  this.tokens.links = {};\n  this.options = options || marked.defaults;\n  this.rules = block.normal;\n\n  if (this.options.gfm) {\n    if (this.options.tables) {\n      this.rules = block.tables;\n    } else {\n      this.rules = block.gfm;\n    }\n  }\n}\n\n/**\n * Expose Block Rules\n */\n\nLexer.rules = block;\n\n/**\n * Static Lex Method\n */\n\nLexer.lex = function(src, options) {\n  var lexer = new Lexer(options);\n  return lexer.lex(src);\n};\n\n/**\n * Preprocessing\n */\n\nLexer.prototype.lex = function(src) {\n  src = src\n    .replace(/\\r\\n|\\r/g, '\\n')\n    .replace(/\\t/g, '    ')\n    .replace(/\\u00a0/g, ' ')\n    .replace(/\\u2424/g, '\\n');\n\n  return this.token(src, true);\n};\n\n/**\n * Lexing\n */\n\nLexer.prototype.token = function(src, top, bq) {\n  var src = src.replace(/^ +$/gm, '')\n    , next\n    , loose\n    , cap\n    , bull\n    , b\n    , item\n    , space\n    , i\n    , l;\n\n  while (src) {\n    // newline\n    if (cap = this.rules.newline.exec(src)) {\n      src = src.substring(cap[0].length);\n      if (cap[0].length > 1) {\n        this.tokens.push({\n          type: 'space'\n        });\n      }\n    }\n\n    // code\n    if (cap = this.rules.code.exec(src)) {\n      src = src.substring(cap[0].length);\n      cap = cap[0].replace(/^ {4}/gm, '');\n      this.tokens.push({\n        type: 'code',\n        text: !this.options.pedantic\n          ? cap.replace(/\\n+$/, '')\n          : cap\n      });\n      continue;\n    }\n\n    // fences (gfm)\n    if (cap = this.rules.fences.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'code',\n        lang: cap[2],\n        text: cap[3] || ''\n      });\n      continue;\n    }\n\n    // heading\n    if (cap = this.rules.heading.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'heading',\n        depth: cap[1].length,\n        text: cap[2]\n      });\n      continue;\n    }\n\n    // table no leading pipe (gfm)\n    if (top && (cap = this.rules.nptable.exec(src))) {\n      src = src.substring(cap[0].length);\n\n      item = {\n        type: 'table',\n        header: cap[1].replace(/^ *| *\\| *$/g, '').split(/ *\\| */),\n        align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n        cells: cap[3].replace(/\\n$/, '').split('\\n')\n      };\n\n      for (i = 0; i < item.align.length; i++) {\n        if (/^ *-+: *$/.test(item.align[i])) {\n          item.align[i] = 'right';\n        } else if (/^ *:-+: *$/.test(item.align[i])) {\n          item.align[i] = 'center';\n        } else if (/^ *:-+ *$/.test(item.align[i])) {\n          item.align[i] = 'left';\n        } else {\n          item.align[i] = null;\n        }\n      }\n\n      for (i = 0; i < item.cells.length; i++) {\n        item.cells[i] = item.cells[i].split(/ *\\| */);\n      }\n\n      this.tokens.push(item);\n\n      continue;\n    }\n\n    // lheading\n    if (cap = this.rules.lheading.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'heading',\n        depth: cap[2] === '=' ? 1 : 2,\n        text: cap[1]\n      });\n      continue;\n    }\n\n    // hr\n    if (cap = this.rules.hr.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'hr'\n      });\n      continue;\n    }\n\n    // blockquote\n    if (cap = this.rules.blockquote.exec(src)) {\n      src = src.substring(cap[0].length);\n\n      this.tokens.push({\n        type: 'blockquote_start'\n      });\n\n      cap = cap[0].replace(/^ *> ?/gm, '');\n\n      // Pass `top` to keep the current\n      // \"toplevel\" state. This is exactly\n      // how markdown.pl works.\n      this.token(cap, top, true);\n\n      this.tokens.push({\n        type: 'blockquote_end'\n      });\n\n      continue;\n    }\n\n    // list\n    if (cap = this.rules.list.exec(src)) {\n      src = src.substring(cap[0].length);\n      bull = cap[2];\n\n      this.tokens.push({\n        type: 'list_start',\n        ordered: bull.length > 1\n      });\n\n      // Get each top-level item.\n      cap = cap[0].match(this.rules.item);\n\n      next = false;\n      l = cap.length;\n      i = 0;\n\n      for (; i < l; i++) {\n        item = cap[i];\n\n        // Remove the list item's bullet\n        // so it is seen as the next token.\n        space = item.length;\n        item = item.replace(/^ *([*+-]|\\d+\\.) +/, '');\n\n        // Outdent whatever the\n        // list item contains. Hacky.\n        if (~item.indexOf('\\n ')) {\n          space -= item.length;\n          item = !this.options.pedantic\n            ? item.replace(new RegExp('^ {1,' + space + '}', 'gm'), '')\n            : item.replace(/^ {1,4}/gm, '');\n        }\n\n        // Determine whether the next list item belongs here.\n        // Backpedal if it does not belong in this list.\n        if (this.options.smartLists && i !== l - 1) {\n          b = block.bullet.exec(cap[i + 1])[0];\n          if (bull !== b && !(bull.length > 1 && b.length > 1)) {\n            src = cap.slice(i + 1).join('\\n') + src;\n            i = l - 1;\n          }\n        }\n\n        // Determine whether item is loose or not.\n        // Use: /(^|\\n)(?! )[^\\n]+\\n\\n(?!\\s*$)/\n        // for discount behavior.\n        loose = next || /\\n\\n(?!\\s*$)/.test(item);\n        if (i !== l - 1) {\n          next = item.charAt(item.length - 1) === '\\n';\n          if (!loose) loose = next;\n        }\n\n        this.tokens.push({\n          type: loose\n            ? 'loose_item_start'\n            : 'list_item_start'\n        });\n\n        // Recurse.\n        this.token(item, false, bq);\n\n        this.tokens.push({\n          type: 'list_item_end'\n        });\n      }\n\n      this.tokens.push({\n        type: 'list_end'\n      });\n\n      continue;\n    }\n\n    // html\n    if (cap = this.rules.html.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: this.options.sanitize\n          ? 'paragraph'\n          : 'html',\n        pre: !this.options.sanitizer\n          && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),\n        text: cap[0]\n      });\n      continue;\n    }\n\n    // def\n    if ((!bq && top) && (cap = this.rules.def.exec(src))) {\n      src = src.substring(cap[0].length);\n      this.tokens.links[cap[1].toLowerCase()] = {\n        href: cap[2],\n        title: cap[3]\n      };\n      continue;\n    }\n\n    // table (gfm)\n    if (top && (cap = this.rules.table.exec(src))) {\n      src = src.substring(cap[0].length);\n\n      item = {\n        type: 'table',\n        header: cap[1].replace(/^ *| *\\| *$/g, '').split(/ *\\| */),\n        align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n        cells: cap[3].replace(/(?: *\\| *)?\\n$/, '').split('\\n')\n      };\n\n      for (i = 0; i < item.align.length; i++) {\n        if (/^ *-+: *$/.test(item.align[i])) {\n          item.align[i] = 'right';\n        } else if (/^ *:-+: *$/.test(item.align[i])) {\n          item.align[i] = 'center';\n        } else if (/^ *:-+ *$/.test(item.align[i])) {\n          item.align[i] = 'left';\n        } else {\n          item.align[i] = null;\n        }\n      }\n\n      for (i = 0; i < item.cells.length; i++) {\n        item.cells[i] = item.cells[i]\n          .replace(/^ *\\| *| *\\| *$/g, '')\n          .split(/ *\\| */);\n      }\n\n      this.tokens.push(item);\n\n      continue;\n    }\n\n    // top-level paragraph\n    if (top && (cap = this.rules.paragraph.exec(src))) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'paragraph',\n        text: cap[1].charAt(cap[1].length - 1) === '\\n'\n          ? cap[1].slice(0, -1)\n          : cap[1]\n      });\n      continue;\n    }\n\n    // text\n    if (cap = this.rules.text.exec(src)) {\n      // Top-level should never reach here.\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'text',\n        text: cap[0]\n      });\n      continue;\n    }\n\n    if (src) {\n      throw new\n        Error('Infinite loop on byte: ' + src.charCodeAt(0));\n    }\n  }\n\n  return this.tokens;\n};\n\n/**\n * Inline-Level Grammar\n */\n\nvar inline = {\n  escape: /^\\\\([\\\\`*{}\\[\\]()#+\\-.!_>])/,\n  autolink: /^<([^ >]+(@|:\\/)[^ >]+)>/,\n  url: noop,\n  tag: /^<!--[\\s\\S]*?-->|^<\\/?\\w+(?:\"[^\"]*\"|'[^']*'|[^'\">])*?>/,\n  link: /^!?\\[(inside)\\]\\(href\\)/,\n  reflink: /^!?\\[(inside)\\]\\s*\\[([^\\]]*)\\]/,\n  nolink: /^!?\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\]/,\n  strong: /^__([\\s\\S]+?)__(?!_)|^\\*\\*([\\s\\S]+?)\\*\\*(?!\\*)/,\n  em: /^\\b_((?:[^_]|__)+?)_\\b|^\\*((?:\\*\\*|[\\s\\S])+?)\\*(?!\\*)/,\n  code: /^(`+)\\s*([\\s\\S]*?[^`])\\s*\\1(?!`)/,\n  br: /^ {2,}\\n(?!\\s*$)/,\n  del: noop,\n  text: /^[\\s\\S]+?(?=[\\\\<!\\[_*`]| {2,}\\n|$)/\n};\n\ninline._inside = /(?:\\[[^\\]]*\\]|[^\\[\\]]|\\](?=[^\\[]*\\]))*/;\ninline._href = /\\s*<?([\\s\\S]*?)>?(?:\\s+['\"]([\\s\\S]*?)['\"])?\\s*/;\n\ninline.link = replace(inline.link)\n  ('inside', inline._inside)\n  ('href', inline._href)\n  ();\n\ninline.reflink = replace(inline.reflink)\n  ('inside', inline._inside)\n  ();\n\n/**\n * Normal Inline Grammar\n */\n\ninline.normal = merge({}, inline);\n\n/**\n * Pedantic Inline Grammar\n */\n\ninline.pedantic = merge({}, inline.normal, {\n  strong: /^__(?=\\S)([\\s\\S]*?\\S)__(?!_)|^\\*\\*(?=\\S)([\\s\\S]*?\\S)\\*\\*(?!\\*)/,\n  em: /^_(?=\\S)([\\s\\S]*?\\S)_(?!_)|^\\*(?=\\S)([\\s\\S]*?\\S)\\*(?!\\*)/\n});\n\n/**\n * GFM Inline Grammar\n */\n\ninline.gfm = merge({}, inline.normal, {\n  escape: replace(inline.escape)('])', '~|])')(),\n  url: /^(https?:\\/\\/[^\\s<]+[^<.,:;\"')\\]\\s])/,\n  del: /^~~(?=\\S)([\\s\\S]*?\\S)~~/,\n  text: replace(inline.text)\n    (']|', '~]|')\n    ('|', '|https?://|')\n    ()\n});\n\n/**\n * GFM + Line Breaks Inline Grammar\n */\n\ninline.breaks = merge({}, inline.gfm, {\n  br: replace(inline.br)('{2,}', '*')(),\n  text: replace(inline.gfm.text)('{2,}', '*')()\n});\n\n/**\n * Inline Lexer & Compiler\n */\n\nfunction InlineLexer(links, options) {\n  this.options = options || marked.defaults;\n  this.links = links;\n  this.rules = inline.normal;\n  this.renderer = this.options.renderer || new Renderer;\n  this.renderer.options = this.options;\n\n  if (!this.links) {\n    throw new\n      Error('Tokens array requires a `links` property.');\n  }\n\n  if (this.options.gfm) {\n    if (this.options.breaks) {\n      this.rules = inline.breaks;\n    } else {\n      this.rules = inline.gfm;\n    }\n  } else if (this.options.pedantic) {\n    this.rules = inline.pedantic;\n  }\n}\n\n/**\n * Expose Inline Rules\n */\n\nInlineLexer.rules = inline;\n\n/**\n * Static Lexing/Compiling Method\n */\n\nInlineLexer.output = function(src, links, options) {\n  var inline = new InlineLexer(links, options);\n  return inline.output(src);\n};\n\n/**\n * Lexing/Compiling\n */\n\nInlineLexer.prototype.output = function(src) {\n  var out = ''\n    , link\n    , text\n    , href\n    , cap;\n\n  while (src) {\n    // escape\n    if (cap = this.rules.escape.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += cap[1];\n      continue;\n    }\n\n    // autolink\n    if (cap = this.rules.autolink.exec(src)) {\n      src = src.substring(cap[0].length);\n      if (cap[2] === '@') {\n        text = cap[1].charAt(6) === ':'\n          ? this.mangle(cap[1].substring(7))\n          : this.mangle(cap[1]);\n        href = this.mangle('mailto:') + text;\n      } else {\n        text = escape(cap[1]);\n        href = text;\n      }\n      out += this.renderer.link(href, null, text);\n      continue;\n    }\n\n    // url (gfm)\n    if (!this.inLink && (cap = this.rules.url.exec(src))) {\n      src = src.substring(cap[0].length);\n      text = escape(cap[1]);\n      href = text;\n      out += this.renderer.link(href, null, text);\n      continue;\n    }\n\n    // tag\n    if (cap = this.rules.tag.exec(src)) {\n      if (!this.inLink && /^<a /i.test(cap[0])) {\n        this.inLink = true;\n      } else if (this.inLink && /^<\\/a>/i.test(cap[0])) {\n        this.inLink = false;\n      }\n      src = src.substring(cap[0].length);\n      out += this.options.sanitize\n        ? this.options.sanitizer\n          ? this.options.sanitizer(cap[0])\n          : escape(cap[0])\n        : cap[0]\n      continue;\n    }\n\n    // link\n    if (cap = this.rules.link.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.inLink = true;\n      out += this.outputLink(cap, {\n        href: cap[2],\n        title: cap[3]\n      });\n      this.inLink = false;\n      continue;\n    }\n\n    // reflink, nolink\n    if ((cap = this.rules.reflink.exec(src))\n        || (cap = this.rules.nolink.exec(src))) {\n      src = src.substring(cap[0].length);\n      link = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n      link = this.links[link.toLowerCase()];\n      if (!link || !link.href) {\n        out += cap[0].charAt(0);\n        src = cap[0].substring(1) + src;\n        continue;\n      }\n      this.inLink = true;\n      out += this.outputLink(cap, link);\n      this.inLink = false;\n      continue;\n    }\n\n    // strong\n    if (cap = this.rules.strong.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.strong(this.output(cap[2] || cap[1]));\n      continue;\n    }\n\n    // em\n    if (cap = this.rules.em.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.em(this.output(cap[2] || cap[1]));\n      continue;\n    }\n\n    // code\n    if (cap = this.rules.code.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.codespan(escape(cap[2], true));\n      continue;\n    }\n\n    // br\n    if (cap = this.rules.br.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.br();\n      continue;\n    }\n\n    // del (gfm)\n    if (cap = this.rules.del.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.del(this.output(cap[1]));\n      continue;\n    }\n\n    // text\n    if (cap = this.rules.text.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.text(escape(this.smartypants(cap[0])));\n      continue;\n    }\n\n    if (src) {\n      throw new\n        Error('Infinite loop on byte: ' + src.charCodeAt(0));\n    }\n  }\n\n  return out;\n};\n\n/**\n * Compile Link\n */\n\nInlineLexer.prototype.outputLink = function(cap, link) {\n  var href = escape(link.href)\n    , title = link.title ? escape(link.title) : null;\n\n  return cap[0].charAt(0) !== '!'\n    ? this.renderer.link(href, title, this.output(cap[1]))\n    : this.renderer.image(href, title, escape(cap[1]));\n};\n\n/**\n * Smartypants Transformations\n */\n\nInlineLexer.prototype.smartypants = function(text) {\n  if (!this.options.smartypants) return text;\n  return text\n    // em-dashes\n    .replace(/---/g, '\\u2014')\n    // en-dashes\n    .replace(/--/g, '\\u2013')\n    // opening singles\n    .replace(/(^|[-\\u2014/(\\[{\"\\s])'/g, '$1\\u2018')\n    // closing singles & apostrophes\n    .replace(/'/g, '\\u2019')\n    // opening doubles\n    .replace(/(^|[-\\u2014/(\\[{\\u2018\\s])\"/g, '$1\\u201c')\n    // closing doubles\n    .replace(/\"/g, '\\u201d')\n    // ellipses\n    .replace(/\\.{3}/g, '\\u2026');\n};\n\n/**\n * Mangle Links\n */\n\nInlineLexer.prototype.mangle = function(text) {\n  if (!this.options.mangle) return text;\n  var out = ''\n    , l = text.length\n    , i = 0\n    , ch;\n\n  for (; i < l; i++) {\n    ch = text.charCodeAt(i);\n    if (Math.random() > 0.5) {\n      ch = 'x' + ch.toString(16);\n    }\n    out += '&#' + ch + ';';\n  }\n\n  return out;\n};\n\n/**\n * Renderer\n */\n\nfunction Renderer(options) {\n  this.options = options || {};\n}\n\nRenderer.prototype.code = function(code, lang, escaped) {\n  if (this.options.highlight) {\n    var out = this.options.highlight(code, lang);\n    if (out != null && out !== code) {\n      escaped = true;\n      code = out;\n    }\n  }\n\n  if (!lang) {\n    return '<pre><code>'\n      + (escaped ? code : escape(code, true))\n      + '\\n</code></pre>';\n  }\n\n  return '<pre><code class=\"'\n    + this.options.langPrefix\n    + escape(lang, true)\n    + '\">'\n    + (escaped ? code : escape(code, true))\n    + '\\n</code></pre>\\n';\n};\n\nRenderer.prototype.blockquote = function(quote) {\n  return '<blockquote>\\n' + quote + '</blockquote>\\n';\n};\n\nRenderer.prototype.html = function(html) {\n  return html;\n};\n\nRenderer.prototype.heading = function(text, level, raw) {\n  return '<h'\n    + level\n    + ' id=\"'\n    + this.options.headerPrefix\n    + raw.toLowerCase().replace(/[^\\w]+/g, '-')\n    + '\">'\n    + text\n    + '</h'\n    + level\n    + '>\\n';\n};\n\nRenderer.prototype.hr = function() {\n  return this.options.xhtml ? '<hr/>\\n' : '<hr>\\n';\n};\n\nRenderer.prototype.list = function(body, ordered) {\n  var type = ordered ? 'ol' : 'ul';\n  return '<' + type + '>\\n' + body + '</' + type + '>\\n';\n};\n\nRenderer.prototype.listitem = function(text) {\n  return '<li>' + text + '</li>\\n';\n};\n\nRenderer.prototype.paragraph = function(text) {\n  return '<p>' + text + '</p>\\n';\n};\n\nRenderer.prototype.table = function(header, body) {\n  return '<table>\\n'\n    + '<thead>\\n'\n    + header\n    + '</thead>\\n'\n    + '<tbody>\\n'\n    + body\n    + '</tbody>\\n'\n    + '</table>\\n';\n};\n\nRenderer.prototype.tablerow = function(content) {\n  return '<tr>\\n' + content + '</tr>\\n';\n};\n\nRenderer.prototype.tablecell = function(content, flags) {\n  var type = flags.header ? 'th' : 'td';\n  var tag = flags.align\n    ? '<' + type + ' style=\"text-align:' + flags.align + '\">'\n    : '<' + type + '>';\n  return tag + content + '</' + type + '>\\n';\n};\n\n// span level renderer\nRenderer.prototype.strong = function(text) {\n  return '<strong>' + text + '</strong>';\n};\n\nRenderer.prototype.em = function(text) {\n  return '<em>' + text + '</em>';\n};\n\nRenderer.prototype.codespan = function(text) {\n  return '<code>' + text + '</code>';\n};\n\nRenderer.prototype.br = function() {\n  return this.options.xhtml ? '<br/>' : '<br>';\n};\n\nRenderer.prototype.del = function(text) {\n  return '<del>' + text + '</del>';\n};\n\nRenderer.prototype.link = function(href, title, text) {\n  if (this.options.sanitize) {\n    try {\n      var prot = decodeURIComponent(unescape(href))\n        .replace(/[^\\w:]/g, '')\n        .toLowerCase();\n    } catch (e) {\n      return '';\n    }\n    if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0) {\n      return '';\n    }\n  }\n  var out = '<a href=\"' + href + '\"';\n  if (title) {\n    out += ' title=\"' + title + '\"';\n  }\n  out += '>' + text + '</a>';\n  return out;\n};\n\nRenderer.prototype.image = function(href, title, text) {\n  var out = '<img src=\"' + href + '\" alt=\"' + text + '\"';\n  if (title) {\n    out += ' title=\"' + title + '\"';\n  }\n  out += this.options.xhtml ? '/>' : '>';\n  return out;\n};\n\nRenderer.prototype.text = function(text) {\n  return text;\n};\n\n/**\n * Parsing & Compiling\n */\n\nfunction Parser(options) {\n  this.tokens = [];\n  this.token = null;\n  this.options = options || marked.defaults;\n  this.options.renderer = this.options.renderer || new Renderer;\n  this.renderer = this.options.renderer;\n  this.renderer.options = this.options;\n}\n\n/**\n * Static Parse Method\n */\n\nParser.parse = function(src, options, renderer) {\n  var parser = new Parser(options, renderer);\n  return parser.parse(src);\n};\n\n/**\n * Parse Loop\n */\n\nParser.prototype.parse = function(src) {\n  this.inline = new InlineLexer(src.links, this.options, this.renderer);\n  this.tokens = src.reverse();\n\n  var out = '';\n  while (this.next()) {\n    out += this.tok();\n  }\n\n  return out;\n};\n\n/**\n * Next Token\n */\n\nParser.prototype.next = function() {\n  return this.token = this.tokens.pop();\n};\n\n/**\n * Preview Next Token\n */\n\nParser.prototype.peek = function() {\n  return this.tokens[this.tokens.length - 1] || 0;\n};\n\n/**\n * Parse Text Tokens\n */\n\nParser.prototype.parseText = function() {\n  var body = this.token.text;\n\n  while (this.peek().type === 'text') {\n    body += '\\n' + this.next().text;\n  }\n\n  return this.inline.output(body);\n};\n\n/**\n * Parse Current Token\n */\n\nParser.prototype.tok = function() {\n  switch (this.token.type) {\n    case 'space': {\n      return '';\n    }\n    case 'hr': {\n      return this.renderer.hr();\n    }\n    case 'heading': {\n      return this.renderer.heading(\n        this.inline.output(this.token.text),\n        this.token.depth,\n        this.token.text);\n    }\n    case 'code': {\n      return this.renderer.code(this.token.text,\n        this.token.lang,\n        this.token.escaped);\n    }\n    case 'table': {\n      var header = ''\n        , body = ''\n        , i\n        , row\n        , cell\n        , flags\n        , j;\n\n      // header\n      cell = '';\n      for (i = 0; i < this.token.header.length; i++) {\n        flags = { header: true, align: this.token.align[i] };\n        cell += this.renderer.tablecell(\n          this.inline.output(this.token.header[i]),\n          { header: true, align: this.token.align[i] }\n        );\n      }\n      header += this.renderer.tablerow(cell);\n\n      for (i = 0; i < this.token.cells.length; i++) {\n        row = this.token.cells[i];\n\n        cell = '';\n        for (j = 0; j < row.length; j++) {\n          cell += this.renderer.tablecell(\n            this.inline.output(row[j]),\n            { header: false, align: this.token.align[j] }\n          );\n        }\n\n        body += this.renderer.tablerow(cell);\n      }\n      return this.renderer.table(header, body);\n    }\n    case 'blockquote_start': {\n      var body = '';\n\n      while (this.next().type !== 'blockquote_end') {\n        body += this.tok();\n      }\n\n      return this.renderer.blockquote(body);\n    }\n    case 'list_start': {\n      var body = ''\n        , ordered = this.token.ordered;\n\n      while (this.next().type !== 'list_end') {\n        body += this.tok();\n      }\n\n      return this.renderer.list(body, ordered);\n    }\n    case 'list_item_start': {\n      var body = '';\n\n      while (this.next().type !== 'list_item_end') {\n        body += this.token.type === 'text'\n          ? this.parseText()\n          : this.tok();\n      }\n\n      return this.renderer.listitem(body);\n    }\n    case 'loose_item_start': {\n      var body = '';\n\n      while (this.next().type !== 'list_item_end') {\n        body += this.tok();\n      }\n\n      return this.renderer.listitem(body);\n    }\n    case 'html': {\n      var html = !this.token.pre && !this.options.pedantic\n        ? this.inline.output(this.token.text)\n        : this.token.text;\n      return this.renderer.html(html);\n    }\n    case 'paragraph': {\n      return this.renderer.paragraph(this.inline.output(this.token.text));\n    }\n    case 'text': {\n      return this.renderer.paragraph(this.parseText());\n    }\n  }\n};\n\n/**\n * Helpers\n */\n\nfunction escape(html, encode) {\n  return html\n    .replace(!encode ? /&(?!#?\\w+;)/g : /&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nfunction unescape(html) {\n  return html.replace(/&([#\\w]+);/g, function(_, n) {\n    n = n.toLowerCase();\n    if (n === 'colon') return ':';\n    if (n.charAt(0) === '#') {\n      return n.charAt(1) === 'x'\n        ? String.fromCharCode(parseInt(n.substring(2), 16))\n        : String.fromCharCode(+n.substring(1));\n    }\n    return '';\n  });\n}\n\nfunction replace(regex, opt) {\n  regex = regex.source;\n  opt = opt || '';\n  return function self(name, val) {\n    if (!name) return new RegExp(regex, opt);\n    val = val.source || val;\n    val = val.replace(/(^|[^\\[])\\^/g, '$1');\n    regex = regex.replace(name, val);\n    return self;\n  };\n}\n\nfunction noop() {}\nnoop.exec = noop;\n\nfunction merge(obj) {\n  var i = 1\n    , target\n    , key;\n\n  for (; i < arguments.length; i++) {\n    target = arguments[i];\n    for (key in target) {\n      if (Object.prototype.hasOwnProperty.call(target, key)) {\n        obj[key] = target[key];\n      }\n    }\n  }\n\n  return obj;\n}\n\n\n/**\n * Marked\n */\n\nfunction marked(src, opt, callback) {\n  if (callback || typeof opt === 'function') {\n    if (!callback) {\n      callback = opt;\n      opt = null;\n    }\n\n    opt = merge({}, marked.defaults, opt || {});\n\n    var highlight = opt.highlight\n      , tokens\n      , pending\n      , i = 0;\n\n    try {\n      tokens = Lexer.lex(src, opt)\n    } catch (e) {\n      return callback(e);\n    }\n\n    pending = tokens.length;\n\n    var done = function(err) {\n      if (err) {\n        opt.highlight = highlight;\n        return callback(err);\n      }\n\n      var out;\n\n      try {\n        out = Parser.parse(tokens, opt);\n      } catch (e) {\n        err = e;\n      }\n\n      opt.highlight = highlight;\n\n      return err\n        ? callback(err)\n        : callback(null, out);\n    };\n\n    if (!highlight || highlight.length < 3) {\n      return done();\n    }\n\n    delete opt.highlight;\n\n    if (!pending) return done();\n\n    for (; i < tokens.length; i++) {\n      (function(token) {\n        if (token.type !== 'code') {\n          return --pending || done();\n        }\n        return highlight(token.text, token.lang, function(err, code) {\n          if (err) return done(err);\n          if (code == null || code === token.text) {\n            return --pending || done();\n          }\n          token.text = code;\n          token.escaped = true;\n          --pending || done();\n        });\n      })(tokens[i]);\n    }\n\n    return;\n  }\n  try {\n    if (opt) opt = merge({}, marked.defaults, opt);\n    return Parser.parse(Lexer.lex(src, opt), opt);\n  } catch (e) {\n    e.message += '\\nPlease report this to https://github.com/chjj/marked.';\n    if ((opt || marked.defaults).silent) {\n      return '<p>An error occured:</p><pre>'\n        + escape(e.message + '', true)\n        + '</pre>';\n    }\n    throw e;\n  }\n}\n\n/**\n * Options\n */\n\nmarked.options =\nmarked.setOptions = function(opt) {\n  merge(marked.defaults, opt);\n  return marked;\n};\n\nmarked.defaults = {\n  gfm: true,\n  tables: true,\n  breaks: false,\n  pedantic: false,\n  sanitize: false,\n  sanitizer: null,\n  mangle: true,\n  smartLists: false,\n  silent: false,\n  highlight: null,\n  langPrefix: 'lang-',\n  smartypants: false,\n  headerPrefix: '',\n  renderer: new Renderer,\n  xhtml: false\n};\n\n/**\n * Expose\n */\n\nmarked.Parser = Parser;\nmarked.parser = Parser.parse;\n\nmarked.Renderer = Renderer;\n\nmarked.Lexer = Lexer;\nmarked.lexer = Lexer.lex;\n\nmarked.InlineLexer = InlineLexer;\nmarked.inlineLexer = InlineLexer.output;\n\nmarked.parse = marked;\n\nif (typeof module !== 'undefined' && typeof exports === 'object') {\n  module.exports = marked;\n} else if (typeof define === 'function' && define.amd) {\n  define(function() { return marked; });\n} else {\n  this.marked = marked;\n}\n\n}).call(function() {\n  return this || (typeof window !== 'undefined' ? window : global);\n}());\n","/**\n * The root component of the box sequence problem.\n * This component does the following\n *   1. Displays the sequence component.\n *   2. Displays the recall component.\n *   3. Optionally displays the feedback component.\n * @prop sequence   array<point> An array of colored cells.\n * @prop feedback   boolean      If feedback should be displayed.\n * @prop onComplete callback\n */\nvar BoxSequence = React.createClass({\n    propTypes: {\n        probId: React.PropTypes.number.isRequired,\n        questionId: React.PropTypes.number.isRequired,\n        sequence: React.PropTypes.array.isRequired,\n        feedback: React.PropTypes.bool,\n        onComplete: React.PropTypes.func.isRequired\n    },\n    getInitialState: function() {\n        return {stage: 0};\n    },\n    advance: function() {\n        if(this.state.stage < 1 || (this.state.stage == 1 && this.props.feedback))\n            this.setState({stage: this.state.stage + 1});\n        else\n            this.props.onComplete({probId: this.props.probId, questionId: this.props.questionId, response: this.res.res, time: (this.res.endTime - this.res.startTime)});\n    },\n    /**\n     * Handles recall response from the user.\n     * @param res       array<point> A list of cells where user clicked, in the order they were clicked.\n     * @param startTime integer\n     * @param endTime   integer\n     */\n    onRecallComplete: function(res, startTime, endTime) {\n        this.res = {res: res, startTime: startTime, endTime: endTime};\n        this.advance();\n    },\n    render: function() {\n        switch(this.state.stage) {\n            case 0:\n                return (\n                    <BoxSequence.SlideSet sequence={this.props.sequence} onComplete={this.advance} />\n                );\n            case 1:\n                return (\n                    <BoxSequence.Recall sequence={this.props.sequence} onComplete={this.onRecallComplete} />\n                );\n            case 2:\n                return (\n                    <BoxSequence.Feedback sequence={this.props.sequence} response={this.res} onComplete={this.advance} />\n                );\n        }\n    },\n    statics: {\n        generateRandomProblem: function(length) {\n            var res = {type: 'squares', problem: []};\n\n            while(res.problem.length < length) {\n                var x = Math.floor(Math.random() * 4);\n                var y = Math.floor(Math.random() * 4);\n                var p = [x, y];\n                if(!arrayHasPoint(res.problem, p))\n                    res.problem.push(p);\n            }\n\n            return res;\n        }\n    }\n});\n\n/**\n * Displays a sequence colored boxes.\n * @prop sequence array<point> An array of locations.\n * @prop onComplete callback\n */\nBoxSequence.SlideSet = React.createClass({\n    getInitialState: function() {\n        return {count: 0};\n    },\n    advance: function() {\n        if(this.state.count < this.props.sequence.length - 1)\n            this.setState({count: this.state.count + 1});\n        else\n            this.props.onComplete();\n    },\n    render: function() {\n        return (\n            <BoxSequence.Slide \n                key={this.state.count}\n                colored={[this.props.sequence[this.state.count]]}\n                onComplete={this.advance} />\n        );\n    }\n});\n\n/**\n * A single slide of the sequence.\n * @prop colored array<point> An array specified which box should be color-filled.\n * @prop onComplete callback\n */\nBoxSequence.Slide = React.createClass({\n    componentDidMount: function() {\n        this.timer = setInterval(this.timeup, 1000);\n    },\n    timeup: function() {\n        clearInterval(this.timer);\n        this.props.onComplete();\n    },\n    render: function() {\n        return (\n            <div>\n                <div className=\"row\" style={{marginBottom:20}}>\n                    <div className=\"col-xs-12\" style={{fontSize:20, textAlign:'center'}}>\n                        &nbsp;\n                    </div>\n                </div>\n                <div className=\"row\" style={{marginBottom:25}}>\n                    <div className=\"col-md-6 col-md-offset-3 col-xs-8 col-xs-offset-2\">\n                        <BoxSequence.Slide.Figure rows={4} cols={4} colored={this.props.colored} />\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col-xs-12\">\n                        <button className=\"btn btn-default\" style={{visibility:'hidden'}}>Spacer</button>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n});\n\n/**\n * @prop rows        integer       Number of rows.\n * @prop cols        integer       Number of columns.\n * @prop colored     array<point>  An array specified which box should be color-filled.\n * @prop cellText    array<object> Cell text with format {loc: [x, y], text:'text'}.\n * @prop borderColor string        Color code of border. \n * @prop loColor     string        Color code of non-highlighted cell.\n * @prop hiColor     string        Color code of highlighted cell.\n * @prop onCellClick callback\n */\nBoxSequence.Slide.Figure = React.createClass({\n    propTypes: {\n        rows: React.PropTypes.number.isRequired,\n        cols: React.PropTypes.number.isRequired,\n        colored: React.PropTypes.array,\n        cellText: React.PropTypes.array,\n        borderColor: React.PropTypes.string,\n        loColor: React.PropTypes.string,\n        hiColor: React.PropTypes.string,\n        class: React.PropTypes.string,\n        onCellClick: React.PropTypes.func\n    },\n    getDefaultProps: function() {\n        return {\n            borderColor: '#555',\n            loColor: '#ffffff',\n            hiColor: '#005997',\n        };\n    },\n    componentDidMount: function() {\n        var svg = this.props.class ? $('') : $('svg.' + this.props.class);\n        var width = svg.width();\n        svg.height(width);\n    },\n    onCellClick: function(cell) {\n        if(this.props.onCellClick)\n            this.props.onCellClick(cell);\n    },\n    /**\n     * Checks if a cell is colored against props 'colored'.\n     * @param cell array<integer> An array consisting two elements [x, y].\n     */\n    cellIsColored: function(cell) {\n        if(!this.props.colored)\n            return false;\n\n        for(var i = 0; i < this.props.colored.length; i++)\n            if(cell[0] == this.props.colored[i][0] && cell[1] == this.props.colored[i][1])\n                return true;\n        return false;\n    },\n    /**\n     * Returns the index of this.props.cellText for this cell, or -1 if this cell\n     * does not have text.\n     */\n    cellTextIndex: function(cell) {\n        if(!this.props.cellText)\n            return -1;\n        for(var i = 0; i < this.props.cellText.length; i++)\n            if(this.props.cellText[i].loc &&\n                cell[0] == this.props.cellText[i].loc[0] && \n                cell[1] == this.props.cellText[i].loc[1])\n                return i;\n        return -1;\n    },\n    render: function() {\n        var x0 = 25, y0 = 25;\n        var width = 100;\n        var cells = [];\n\n        //Make the cells to draw\n        for(var x = 0; x < this.props.cols; x++)\n            for(var y = 0; y < this.props.rows; y++)\n                cells.push([x, y]);\n\n        var viewBoxW = this.props.cols * width + x0;\n        var viewBoxH = this.props.rows * width + y0;\n\n        return (\n            <svg className={this.props.class} style={{width:'100%'}} viewBox={'0 0 ' + viewBoxH + ' ' + viewBoxH}>\n                {\n                    cells.map(function(cell, index) {\n                        if(this.cellTextIndex(cell) != -1)\n                            return (\n                                <g key={index} onClick={this.onCellClick.bind(this, cell)} style={{cursor:this.props.onCellClick ? 'pointer' : 'auto'}}>\n                                    <rect x={x0 + width * cell[0]} y={y0 + width * cell[1]} width={width} height={width}\n                                        stroke={this.props.borderColor}\n                                        fill={this.cellIsColored(cell) ? this.props.hiColor : this.props.loColor}>\n                                    </rect>\n                                    {/*<circle\n                                        cx={x0 + (width * cell[0] + width * (cell[0] + 1)) / 2}\n                                        cy={y0 + width * cell[1] + 65} r=\"3\" fill=\"red\" />*/}\n                                    <text textAnchor='middle'\n                                        x={x0 + (width * cell[0] + width * (cell[0] + 1)) / 2}\n                                        y={y0 + width * cell[1] + 65}\n                                        fontSize='50' \n                                        fill='black'>\n                                        {this.props.cellText[this.cellTextIndex(cell)].text}\n                                    </text>\n                                </g>\n                            )\n                        else\n                            return (\n                                <g key={index} onClick={this.onCellClick.bind(this, cell)} style={{cursor:this.props.onCellClick ? 'pointer' : 'auto'}}>\n                                    <rect key={index} x={x0 + width * cell[0]} y={y0 + width * cell[1]}\n                                        width={width} height={width} stroke={this.props.borderColor}\n                                        fill={this.cellIsColored(cell) ? this.props.hiColor : this.props.loColor}>\n                                    </rect>\n                                </g>\n                            );\n                    }, this)\n                }\n            </svg>\n        );\n    }\n});\n\n/**\n * The recall screen.\n * @prop sequence   array<point>\n * @prop onComplete callback\n */\nBoxSequence.Recall = React.createClass({\n    getInitialState: function() {\n        return {selects: this.props.sequence.map(function(){\n            return null;\n        })};\n    },\n    componentDidMount: function() {\n        this.startTime = new Date().getTime();\n    },\n    /**\n     * If the cell has been selected, return its index in this.state.selects;\n     * return -1 otherwise.\n     * @param cell array<integer>\n     */\n    getCellSelectIndex: function(cell) {\n        var s = this.state.selects;\n        for(var i = 0; i < s.length; i++)\n            if(s[i] && s[i][0] == cell[0] && s[i][0] == cell[0] && s[i][1] == cell[1])\n                return i;\n        return -1;\n    },\n    onCellClick: function(cell) {\n        var index = this.getCellSelectIndex(cell);\n        var selects = this.state.selects;\n\n        if(index == -1) {\n            for(var i = 0; i < selects.length; i++) {\n                if(selects[i] == null) {\n                    selects[i] = cell;\n                    this.setState({selects: selects});\n                    break;\n                }\n            }\n        }\n        else {\n            selects[index] = null;\n            this.setState({selects: selects});\n        }\n    },\n    onClear: function() {\n        for(var i = 0; i < this.state.selects.length; i++)\n            this.state.selects[i] = null;\n        this.setState({selects: this.state.selects});\n    },\n    onComplete: function() {\n        var endTime = new Date().getTime();\n        this.props.onComplete(this.state.selects, this.startTime, endTime);\n    },\n    render: function() {\n        //Make cell text\n        var cellText = this.state.selects.map(function(cell, index){\n            return {loc:cell, text:index + 1};\n        });\n\n        return (\n            <div>\n                <div className=\"row\" style={{marginBottom:20}}>\n                    <div className=\"col-xs-12\" style={{fontSize:20, textAlign:'center'}}>\n                        {translate('Please recall the order of the blue boxes')}\n                    </div>\n                </div>\n                <div className=\"row\" style={{marginBottom:25}}>\n                    <div className=\"col-md-6 col-md-offset-3 col-xs-8 col-xs-offset-2\">\n                        <BoxSequence.Slide.Figure rows={4} cols={4} cellText={cellText} onCellClick={this.onCellClick} />\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <div className=\"col-xs-6\">\n                        <button className=\"btn btn-default pull-right\" onClick={this.onClear}>{translate('Clear')}</button>\n                    </div>\n                    <div className=\"col-xs-6\">\n                        <button className=\"btn btn-default pull-left\" onClick={this.onComplete}>{translate('Continue')}</button>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n});\n\n/**\n * The feedback screen.\n * @prop sequence array<point> The original problem sequence\n * @prop response object       The user's response with format\n *                             {res: array<point>, startTime: integer, endTime: integer}\n * @prop onComplete callback\n */\nBoxSequence.Feedback = React.createClass({\n    getCorrectCount: function() {\n        var res = 0;\n        var sequence = this.props.sequence;\n        var response = this.props.response.res;\n\n        for(var i = 0; i < sequence.length; i++)\n            if(response[i] && response[i][0] == sequence[i][0] && response[i][1] == sequence[i][1])\n                res++;\n        return res;\n    },\n    render: function() {\n        return (\n            <div>\n                <div className=\"row\">\n                    <div className=\"col-xs-12\" style={{fontSize:25, marginBottom:25}}>\n                        {translate('You recalled')} {this.getCorrectCount()} {translate('out of')} {this.props.sequence.length} {translate('squares correctly')}.\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <button className=\"btn btn-default\" onClick={this.onComplete}>{translate('Continue')}</button>\n                </div>\n            </div>\n        )\n    },\n    onComplete: function() {\n        if(this.props.onComplete)\n            this.props.onComplete();\n    }\n});","/**\n * Dependencies\n *   - sq.js\n */\n\nvar SymmetryTest = React.createClass({\n    propTypes: {\n        probId: React.PropTypes.number,             //Problem id\n        questionId: React.PropTypes.number.isRequired, //Assessment question id\n        colored: React.PropTypes.array.isRequired,  //Array of points that specifies which box should be color-filled.\n        tra: React.PropTypes.object,                //Task running accuracy\n        feedback: React.PropTypes.bool,             //If feedback should be displayed\n        onComplete: React.PropTypes.func.isRequired, //Callback when this component is finished.\n        timeLimit: React.PropTypes.number.isRequired,\n    },\n    getInitialState: function() {\n        return {stage: 0};\n    },\n    componentDidMount: function() {\n        this.startTime = new Date().getTime();\n        this.timeLimit = setInterval(this.onSymmetryTimeUp, (this.props.timeLimit ? this.props.timeLimit : 8000));\n    },\n    onSymmetryTimeUp: function() {\n        clearInterval(this.timeLimit);\n        var endTime = new Date().getTime();\n        // console.log('time is up: ', endTime - this.startTime);\n        this.res = null;\n        this.time = endTime - this.startTime;\n\n        this.advance();\n    },\n    /**\n     * Handles the event when user click on true or false.\n     * @params res boolean The user's response\n     */\n    onRespond: function(res) {\n        clearInterval(this.timeLimit);\n        var endTime = new Date().getTime();\n        //console.log('submitted early: ', endTime - this.startTime);\n        this.res = res;\n        this.time = endTime - this.startTime;\n\n        this.adjustTra(res);\n        this.advance();\n    },\n    adjustTra: function(res) {\n        if(!this.props.tra)\n            return;\n        \n        this.tra = this.props.tra;\n\n        if(res == SY.isSymmetric(this.props.colored))\n            this.tra.correct++;\n        this.tra.total++;\n    },\n    advance: function() {\n        if(this.state.stage == 0 && this.props.feedback)\n            this.setState({stage: 1});\n        else {\n            this.onComplete();\n        }\n    },\n    onComplete:function() {\n        if (!this.tra)\n            this.tra = this.props.tra;\n        if(this.props.probId == undefined)\n            this.props.onComplete({response: this.res, time: this.time}, this.tra);\n        else\n            this.props.onComplete({probId: this.props.probId, questionId:this.props.questionId, response: this.res, time: this.time}, this.tra);\n\n\n    },\n    render: function(){\n        switch(this.state.stage) {\n            case 0:\n                return (\n                    <div>\n                        <div className=\"row\" style={{marginBottom:25}}>\n                            <div className=\"col-md-6 col-md-offset-3 col-xs-8 col-xs-offset-2\">\n                                <BoxSequence.Slide.Figure rows={8} cols={8} colored={this.props.colored} borderColor={'#000'} hiColor={'#000'} timeLimit={this.props.timeLimit} />\n                            </div>\n                        </div>\n                        <div className=\"row\">\n                            <div className=\"col-xs-6\">\n                                <button className=\"btn btn-default pull-right\" onClick={this.onRespond.bind(this, true)}>{translate('True')}</button>\n                            </div>\n                            <div className=\"col-xs=6\">\n                                <button className=\"btn btn-default pull-left\" onClick={this.onRespond.bind(this, false)}>{translate('False')}</button>\n                            </div>\n                        </div>\n                        {\n                            this.props.tra ? <SymmetryTest.Tra tra={this.props.tra} /> : null\n                        }\n                    </div>\n                )\n            case 1:\n                return (<SymmetryTest.Feedback colored={this.props.colored} res={this.res} onComplete={this.onComplete} />)\n        }\n    }\n});\n\n/*\n * @prop tra object Task Running Accuracy\n */\nSymmetryTest.Tra = React.createClass({\n    render: function() {\n        return null;\n        // return (\n        //     <div style={{position:'fixed', bottom:20, left:0, width:'100%', textAlign:'center'}}>\n        //         <b>Symmetry Accuracy</b> <br/> Correct: {this.props.tra.correct} | Incorrect: {this.props.tra.total - this.props.tra.correct} | Total: {this.props.tra.total}\n        //     </div>\n        // );\n    }\n});\n\n/**\n * @prop colored array<point>\n * @prop res     object with the format {res: boolean, startTime: integer, endTime: integer}\n * @prop onComplete callback\n */\nSymmetryTest.Feedback = React.createClass({\n    propTypes: {\n        colored: React.PropTypes.array.isRequired,\n        res: React.PropTypes.bool.isRequired,\n        onComplete: React.PropTypes.func.isRequired\n    },\n    onComplete: function() {\n        if(this.props.onComplete)\n            this.props.onComplete();\n    },\n    render: function() {\n        return (\n            <div>\n                <div className=\"row\">\n                    <div className=\"col-xs-12\" style={{fontSize:25, marginBottom:25}}>\n                        {translate('Your answer is')} {SY.isSymmetric(this.props.colored) == this.props.res ? translate('correct') : translate('incorrect')}.\n                    </div>\n                </div>\n                <div className=\"row\">\n                    <button className=\"btn btn-default\" onClick={this.onComplete}>{translate('Continue')}</button>\n                </div>\n            </div>\n        )\n    }\n});","var taskTemplate = {\n\n};\n\ntaskTemplate.ospan = {\n    blocks: [\n        {\n            practice: true,\n            problems: [\n                {id: 0, type: LS.typeId, letters: ['G', 'H']},\n                {id: 1, type: LS.typeId, letters: ['P', 'F', 'D']},\n                {id: 2, type: LS.typeId, letters: ['V', 'R', 'S', 'N']}\n            ]\n        },\n        {\n            practice: true,\n            problems: [\n                {id: 0, type: EQ.typeId, equation: '(2*4)+1=5'},\n                {id: 1, type: EQ.typeId, equation: '(24/2)-6=1'},\n                {id: 2, type: EQ.typeId, equation: '(10/2)+2=6'},\n                {id: 3, type: EQ.typeId, equation: '(2*3)-3=3'},\n                {id: 4, type: EQ.typeId, equation: '(2*2)+2=6'},\n                {id: 5, type: EQ.typeId, equation: '(7/7)+7=8'}\n            ]\n        },\n        {\n            practice: true,\n            problems: [\n                {\n                    id: 0,\n                    type: EQLS.typeId,\n                    letters: ['G', 'H'],\n                    equations: [\n                        '(10*2)-10=10',\n                        '(1*2)+1=2'\n                    ]\n                },\n                {\n                    id: 1,\n                    type: EQLS.typeId,\n                    letters: ['P', 'F', 'D'],\n                    equations: [\n                        '(5*2)-10=10',\n                        '(10*3)+1=15',\n                        '(10/5)+5=7'\n                    ]\n                },\n                {\n                    id: 2,\n                    type: EQLS.typeId,\n                    letters: ['V', 'R', 'S', 'N'],\n                    equations: [\n                        '(6*2)-10=3',\n                        '(6/3)+3=5',\n                        '(7*2)-7=7',\n                        '(8*2)-1=16'\n                    ]\n                }\n            ]\n        },\n        {\n            practice: false,\n            problems: [\n                {\n                    id: 0,\n                    type: EQLS.typeId,\n                    letters: ['D', 'L', 'P'],\n                    equations: [\n                        '(9*2)-10=8',\n                        '(3*4)+5=30',\n                        '(5*4)-19=1'\n                    ]\n                },\n                {\n                    id: 1,\n                    type: EQLS.typeId,\n                    letters: ['P', 'L', 'D', 'F'],\n                    equations: [\n                        '(25*2)-10=20',\n                        '(10*10)-10=90',\n                        '(4*5)+5=15',\n                        '(10/5)+5=7'\n                    ]\n                },\n                {\n                    id: 2,\n                    type: EQLS.typeId,\n                    letters: ['P', 'R', 'S', 'Y', 'N'],\n                    equations: [\n                        '(10/2)+6=4',\n                        '(8*3)-8=16',\n                        '(6/2)-1=2',\n                        '(3*12)+3=12',\n                        '(6*8)-2=20'\n                    ]\n                },\n                {\n                    id: 3,\n                    type: EQLS.typeId,\n                    letters: ['Q', 'X', 'Z', 'D', 'C', 'V'],\n                    equations: [\n                        '(3*5)-10=8',\n                        '(15*2)-15=0',\n                        '(5*2)-3=5',\n                        '(10/2)+6=11',\n                        '(4/2)-1=10',\n                        '(8*6)+5=53'\n                    ]\n                },\n                {\n                    id: 4,\n                    type: EQLS.typeId,\n                    letters: ['S', 'F', 'G', 'H', 'J', 'K', 'L'],\n                    equations: [\n                        '(10/5)-2=1',\n                        '(12/3)-4=0',\n                        '(4*4)+4=20',\n                        '(12/4)-3=4',\n                        '(25*2)-10=20',\n                        '(8*6)-8=30',\n                        '(5/5)+2=1'\n                    ]\n                }\n            ]\n        },\n        {\n            practice: false,\n            problems: [\n                {\n                    id: 0,\n                    type: EQLS.typeId,\n                    letters: ['G', 'W', 'J'],\n                    equations: [\n                        '(9*2)-10=8',\n                        '(3*4)+5=30',\n                        '(5*4)-3=17'\n                    ]\n                },\n                {\n                    id: 1,\n                    type: EQLS.typeId,\n                    letters: ['D', 'L', 'T', 'Q'],\n                    equations: [\n                        '(25*2)-10=20',\n                        '(4*1)+20=24',\n                        '(4*5)+5=15',\n                        '(10/5)+5=7'\n                    ]\n                },\n                {\n                    id: 2,\n                    type: EQLS.typeId,\n                    letters: ['R', 'F', 'V', 'S', 'W'],\n                    equations: [\n                        '(10/2)+6=4',\n                        '(8*3)-8=16',\n                        '(6/2)-1=2',\n                        '(3*12)+3=12',\n                        '(6*8)-2=20'\n                    ]\n                },\n                {\n                    id: 3,\n                    type: EQLS.typeId,\n                    letters: ['T', 'X', 'G', 'D', 'C', 'V'],\n                    equations: [\n                        '(13*2)-10=14',\n                        '(15*2)-20=0',\n                        '(5*2)-3=5',\n                        '(10*8)+2=82',\n                        '(4/2)-1=10',\n                        '(8*6)+5=53'\n                    ]\n                },\n                {\n                    id: 4,\n                    type: EQLS.typeId,\n                    letters: ['R', 'W', 'V', 'H', 'Q', 'K', 'P'],\n                    equations: [\n                        '(10/5)-2=1',\n                        '(3*3)-5=4',\n                        '(4/4)+4=5',\n                        '(12/4)-3=4',\n                        '(25*2)-10=20',\n                        '(8/2)+4=6',\n                        '(5/5)+2=1'\n                    ]\n                }\n            ]\n        }\n    ],\n    instructs: [\n        {\n            text: 'Welcome. The task you will be completing today involves two things: remembering letters and solving simple math problems. First, you will practice each part before you begin the task. Please read the instructions carefully so you know how to do the task.\\n\\nPlease click the CONTINUE button to begin',\n            next: 'Continue'\n        },\n        {\n            text: 'You will now practice remembering letters.  You will see one letter at a time presented and your goal is to remember the letters in the exact order that they appeared on the screen. After a set of letters is presented, you will see a screen with 12 possible letters.  You will click on each letter in the order you think they were presented to you. A number will appear next to the letter to indicate its position. For example, 1 will appear for the first letter, a 2 for the second letter and so on. If you need to change or adjust the order of the letters, please use the CLEAR button.\\n\\nOnce you think you have all the letters in the correct order, click CONTINUE to see the next set of letters.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        {\n        \n            text: 'You have completed the practice.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        { //5\n            text: 'You will now practice solving the simple math problems. You will see a math problem such as (2x2) + 3 = 5? Presented on the screen. Your goal is solve the problem and indicate whether the number after the = sign is true or false. In this example, (2x2) + 3 does not equal 5, so you would click the FALSE button.\\n\\nAfter you click on the TRUE or FALSE button, you will see whether your answer was correct or incorrect. Your goal is to solve each problem correctly as quickly as you can.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        { //7\n        \n            text: 'You have completed the practice.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        { //8\n            text: 'You will now practice remembering letters and solving math problems together. This practice will prepare you to complete the task and it will be more challenging than doing each part alone.\\n\\nFirst you will see a math problem to solve it by clicking on TRUE or FALSE. Next, you will see a letter. You will need to remember the letter. You will see several math problem and letter combinations in a set. After a set, you will be presented with 12 letters on the screen. As before, you will click on each letter in the order you believe they appeared on the screen.\\n\\nWe will keep track of your responses. If you take too long to respond to the math problem, the task will move on to the next letter and your math will be marked as incorrect. If you answer several incorrect math problems, you will receive a message that you have too many math errors.\\n\\nYour goal is to solve the math problem correctly as quickly as possible AND remember each of the letters in the exact order they appeared on the screen.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        { //10\n            text: 'You have completed the practice session. You are now ready to complete the task.\\n\\nYour goal is to solve the math problem correctly as quickly as possible AND remember each of the letters in the exact order they appeared on the screen.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        { //11\n            text: 'You are now ready to begin the task.\\n\\nYour goal is to solve the math problem correctly as quickly as possible AND remember each of the letters in the exact order they appeared on the screen.\\n\\nThe task can be challenging, and we ask you to try to do your best.\\n\\nPlease click START to move to next part of the task.',\n            next: 'Start'\n        }\n    ],\n    struct: [\n        {type: 'inst',  id: 0},\n        {type: 'inst',  id: 1},\n        {type: 'block', id: 0},\n        {type: 'inst',  id: 2},\n        {type: 'inst',  id: 3},\n        {type: 'block', id: 1},\n        {type: 'inst',  id: 4},\n        {type: 'inst',  id: 5},\n        {type: 'block', id: 2},\n        {type: 'inst',  id: 6},\n        {type: 'inst',  id: 7},\n        {type: 'block', id: 3},\n        {type: 'block', id: 4}\n    ]\n};\n\ntaskTemplate.sspan = {\n    blocks: [\n        {\n            practice: true,\n            problems: [\n                {id: 0, type: SQ.typeId, squares: SQ.makeRandomFigure(2)},\n                {id: 1, type: SQ.typeId, squares: SQ.makeRandomFigure(3)},\n                {id: 2, type: SQ.typeId, squares: SQ.makeRandomFigure(4)}\n            ]\n        },\n        {\n            practice: true,\n            problems: [\n                {id: 0, type: SY.typeId, symmetry: SY.makeFigure()},\n                {id: 1, type: SY.typeId, symmetry: SY.makeFigure()},\n                {id: 2, type: SY.typeId, symmetry: SY.makeFigure()}\n            ]\n        },\n        {\n            practice: true,\n            problems: [\n                {id: 0, type: SYSQ.typeId, squares: SQ.makeRandomFigure(2), symmetries: SYSQ.makeSymmetryFigures(2)},\n                {id: 1, type: SYSQ.typeId, squares: SQ.makeRandomFigure(3), symmetries: SYSQ.makeSymmetryFigures(3)},\n                {id: 2, type: SYSQ.typeId, squares: SQ.makeRandomFigure(4), symmetries: SYSQ.makeSymmetryFigures(4)}\n            ]\n        },\n        {\n            practice: false,\n            problems: [\n                {id: 0, type: SYSQ.typeId, squares: SQ.makeRandomFigure(3), symmetries: SYSQ.makeSymmetryFigures(3)},\n                {id: 1, type: SYSQ.typeId, squares: SQ.makeRandomFigure(4), symmetries: SYSQ.makeSymmetryFigures(4)},\n                {id: 2, type: SYSQ.typeId, squares: SQ.makeRandomFigure(5), symmetries: SYSQ.makeSymmetryFigures(5)},\n                {id: 3, type: SYSQ.typeId, squares: SQ.makeRandomFigure(6), symmetries: SYSQ.makeSymmetryFigures(6)},\n                {id: 4, type: SYSQ.typeId, squares: SQ.makeRandomFigure(7), symmetries: SYSQ.makeSymmetryFigures(7)}\n            ]\n        },\n        {\n            practice: false,\n            problems: [\n                {id: 0, type: SYSQ.typeId, squares: SQ.makeRandomFigure(3), symmetries: SYSQ.makeSymmetryFigures(3)},\n                {id: 1, type: SYSQ.typeId, squares: SQ.makeRandomFigure(4), symmetries: SYSQ.makeSymmetryFigures(4)},\n                {id: 2, type: SYSQ.typeId, squares: SQ.makeRandomFigure(5), symmetries: SYSQ.makeSymmetryFigures(5)},\n                {id: 3, type: SYSQ.typeId, squares: SQ.makeRandomFigure(6), symmetries: SYSQ.makeSymmetryFigures(6)},\n                {id: 4, type: SYSQ.typeId, squares: SQ.makeRandomFigure(7), symmetries: SYSQ.makeSymmetryFigures(7)}\n            ]\n        }\n    ],\n    instructs: [\n        {\n            text: 'Welcome. The task you will be completing today involves two things: remembering the location of blue squares on the screen and solving simple symmetry problems. First, you will practice each part before you begin the task. Please read the instructions carefully so you know how to do the task.\\n\\nPlease click the CONTINUE button to begin.',\n            next: 'Continue'\n        },\n        {\n            text: 'You will now practice remembering the position of blue squares.  You will see one blue square appear at a time in a 4x4 grid and your goal is to remember the location of the squares in the exact order that they appeared on the screen. After a set of blue squares is presented, you will see a screen with the 4x4 grid with 16 possible square positions.  You will click on each position on the grid in the order you think the blue squares were presented to you. A number will appear in the grid to mark the position. For example, 1 will appear for the first grid position you click, a 2 for the second grid position and so on. If you need to change or adjust the order of the blue squares, please use the CLEAR button.\\n\\nOnce you think you have all the blue squares in the correct order, click to the CONTINUE screen to see the next set of blue squares.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        {\n            text: 'You have completed the practice.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        {\n            text: 'You will now practice solving the simple symmetry problems. You will see a grid with black squares filled in on the screen. Imagine that there is a vertical line (top to bottom) in the center of the grid. Your task is to indicate whether the black blocks on the left and right side of this imaginary line are identical in position. If the two sides are the same, click on TRUE and if the two sides are different, click on FALSE.\\n\\nAfter you click on the TRUE or FALSE button, you will see whether your answer was correct or incorrect. Your goal is to solve each problem correctly as quickly as you can.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        {\n            text: 'You have completed the practice.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        {\n            text: 'You will now practice remembering the position blue squares and solving symmetry problems together. This practice will prepare you to complete the task and it will be more challenging than doing each part alone.\\n\\nFirst you will see a symmetry problem to solve whether the two sides are identical by clicking on TRUE or FALSE. Next, you will see a blue square on the grid. You will need to remember the position of the blue square. You will see several symmetry problem and blue square combinations in a set. After a set, you will see a blank 4x4 grid with 16 possible square positions.  As before, you will click on each position on the grid in the order you think the blue squares were presented to you.\\n\\nWe will keep track of your responses. If you take too long to respond to the symmetry problem, the task will move on to the next blue square and your response will be marked as incorrect. If you answer several incorrect symmetry problems, you will receive a message that you have too many errors.\\n\\nYour goal is to solve the symmetry problem correctly as quickly as possible AND remember each of the blue squares in the exact order they appeared on the screen.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        {\n            text: 'You have completed the practice of symmetry and blue squares. You are now ready to complete the task.\\n\\nYour goal is to solve the symmetry problem correctly as quickly as possible AND remember each of the blue squares in the exact order they appeared on the screen.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        {\n            text: 'You are now ready to begin the task.\\n\\nYour goal is to solve the symmetry problem correctly as quickly as possible AND remember each of the blue squares in the exact order they appeared on the screen.\\n\\nThe task can be challenging, and we ask you to try to do your best.\\n\\nPlease click START to move to next part of the task.',\n            next: 'Start'\n        }\n    ],\n    struct: [\n        {type: 'inst',  id: 0},\n        {type: 'inst',  id: 1},\n        {type: 'block', id: 0},\n        {type: 'inst',  id: 2},\n        {type: 'inst',  id: 3},\n        {type: 'block', id: 1},\n        {type: 'inst',  id: 4},\n        {type: 'inst',  id: 5},\n        {type: 'block', id: 2},\n        {type: 'inst',  id: 6},\n        {type: 'inst',  id: 7},\n        {type: 'block', id: 3},\n        {type: 'block', id: 4}\n    ]\n}\n\ntaskTemplate.combined = {\n\tblocks: [\n        {\n            practice: true,\n            problems: [\n                {id: 0, type: LS.typeId, letters: ['G', 'H']},\n                {id: 1, type: LS.typeId, letters: ['P', 'F', 'D']},\n                {id: 2, type: LS.typeId, letters: ['V', 'R', 'S', 'N']}\n            ]\n        },\n        {\n            practice: true,\n            problems: [\n                {id: 0, type: EQ.typeId, equation: '(2*4)+1=5'},\n                {id: 1, type: EQ.typeId, equation: '(24/2)-6=1'},\n                {id: 2, type: EQ.typeId, equation: '(10/2)+2=6'},\n                {id: 3, type: EQ.typeId, equation: '(2*3)-3=3'},\n                {id: 4, type: EQ.typeId, equation: '(2*2)+2=6'},\n                {id: 5, type: EQ.typeId, equation: '(7/7)+7=8'}\n            ]\n        },\n        {\n            practice: true,\n            problems: [\n                {\n                    id: 0,\n                    type: EQLS.typeId,\n                    letters: ['G', 'H'],\n                    equations: [\n                        '(10*2)-10=10',\n                        '(1*2)+1=2'\n                    ]\n                },\n                {\n                    id: 1,\n                    type: EQLS.typeId,\n                    letters: ['P', 'F', 'D'],\n                    equations: [\n                        '(5*2)-10=10',\n                        '(10*3)+1=15',\n                        '(10/5)+5=7'\n                    ]\n                },\n                {\n                    id: 2,\n                    type: EQLS.typeId,\n                    letters: ['V', 'R', 'S', 'N'],\n                    equations: [\n                        '(6*2)-10=3',\n                        '(6/3)+3=5',\n                        '(7*2)-7=7',\n                        '(8*2)-1=16'\n                    ]\n                }\n            ]\n        },\n        {\n            practice: false,\n            problems: [\n                {\n                    id: 0,\n                    type: EQLS.typeId,\n                    letters: ['D', 'L', 'P'],\n                    equations: [\n                        '(9*2)-10=8',\n                        '(3*4)+5=30',\n                        '(5*4)-19=1'\n                    ]\n                },\n                {\n                    id: 1,\n                    type: EQLS.typeId,\n                    letters: ['P', 'L', 'D', 'F'],\n                    equations: [\n                        '(25*2)-10=20',\n                        '(10*10)-10=90',\n                        '(4*5)+5=15',\n                        '(10/5)+5=7'\n                    ]\n                },\n                {\n                    id: 2,\n                    type: EQLS.typeId,\n                    letters: ['P', 'R', 'S', 'Y', 'N'],\n                    equations: [\n                        '(10/2)+6=4',\n                        '(8*3)-8=16',\n                        '(6/2)-1=2',\n                        '(3*12)+3=12',\n                        '(6*8)-2=20'\n                    ]\n                },\n                {\n                    id: 3,\n                    type: EQLS.typeId,\n                    letters: ['Q', 'X', 'Z', 'D', 'C', 'V'],\n                    equations: [\n                        '(3*5)-10=8',\n                        '(15*2)-15=0',\n                        '(5*2)-3=5',\n                        '(10/2)+6=11',\n                        '(4/2)-1=10',\n                        '(8*6)+5=53'\n                    ]\n                },\n                {\n                    id: 4,\n                    type: EQLS.typeId,\n                    letters: ['S', 'F', 'G', 'H', 'J', 'K', 'L'],\n                    equations: [\n                        '(10/5)-2=1',\n                        '(12/3)-4=0',\n                        '(4*4)+4=20',\n                        '(12/4)-3=4',\n                        '(25*2)-10=20',\n                        '(8*6)-8=30',\n                        '(5/5)+2=1'\n                    ]\n                }\n            ]\n        },\n        {\n            practice: false,\n            problems: [\n                {\n                    id: 0,\n                    type: EQLS.typeId,\n                    letters: ['G', 'W', 'J'],\n                    equations: [\n                        '(9*2)-10=8',\n                        '(3*4)+5=30',\n                        '(5*4)-3=17'\n                    ]\n                },\n                {\n                    id: 1,\n                    type: EQLS.typeId,\n                    letters: ['D', 'L', 'T', 'Q'],\n                    equations: [\n                        '(25*2)-10=20',\n                        '(4*1)+20=24',\n                        '(4*5)+5=15',\n                        '(10/5)+5=7'\n                    ]\n                },\n                {\n                    id: 2,\n                    type: EQLS.typeId,\n                    letters: ['R', 'F', 'V', 'S', 'W'],\n                    equations: [\n                        '(10/2)+6=4',\n                        '(8*3)-8=16',\n                        '(6/2)-1=2',\n                        '(3*12)+3=12',\n                        '(6*8)-2=20'\n                    ]\n                },\n                {\n                    id: 3,\n                    type: EQLS.typeId,\n                    letters: ['T', 'X', 'G', 'D', 'C', 'V'],\n                    equations: [\n                        '(13*2)-10=14',\n                        '(15*2)-20=0',\n                        '(5*2)-3=5',\n                        '(10*8)+2=82',\n                        '(4/2)-1=10',\n                        '(8*6)+5=53'\n                    ]\n                },\n                {\n                    id: 4,\n                    type: EQLS.typeId,\n                    letters: ['R', 'W', 'V', 'H', 'Q', 'K', 'P'],\n                    equations: [\n                        '(10/5)-2=1',\n                        '(3*3)-5=4',\n                        '(4/4)+4=5',\n                        '(12/4)-3=4',\n                        '(25*2)-10=20',\n                        '(8/2)+4=6',\n                        '(5/5)+2=1'\n                    ]\n                }\n            ]\n        },\n        {\n            practice: true,\n            problems: [\n                {id: 0, type: SQ.typeId, squares: SQ.makeRandomFigure(2)},\n                {id: 1, type: SQ.typeId, squares: SQ.makeRandomFigure(3)},\n                {id: 2, type: SQ.typeId, squares: SQ.makeRandomFigure(4)}\n            ]\n        },\n        {\n            practice: true,\n            problems: [\n                {id: 0, type: SY.typeId, symmetry: SY.makeFigure()},\n                {id: 1, type: SY.typeId, symmetry: SY.makeFigure()},\n                {id: 2, type: SY.typeId, symmetry: SY.makeFigure()}\n            ]\n        },\n        {\n            practice: true,\n            problems: [\n                {id: 0, type: SYSQ.typeId, squares: SQ.makeRandomFigure(2), symmetries: SYSQ.makeSymmetryFigures(2)},\n                {id: 1, type: SYSQ.typeId, squares: SQ.makeRandomFigure(3), symmetries: SYSQ.makeSymmetryFigures(3)},\n                {id: 2, type: SYSQ.typeId, squares: SQ.makeRandomFigure(4), symmetries: SYSQ.makeSymmetryFigures(4)}\n            ]\n        },\n        {\n            practice: false,\n            problems: [\n                {id: 0, type: SYSQ.typeId, squares: SQ.makeRandomFigure(3), symmetries: SYSQ.makeSymmetryFigures(3)},\n                {id: 1, type: SYSQ.typeId, squares: SQ.makeRandomFigure(4), symmetries: SYSQ.makeSymmetryFigures(4)},\n                {id: 2, type: SYSQ.typeId, squares: SQ.makeRandomFigure(5), symmetries: SYSQ.makeSymmetryFigures(5)},\n                {id: 3, type: SYSQ.typeId, squares: SQ.makeRandomFigure(6), symmetries: SYSQ.makeSymmetryFigures(6)},\n                {id: 4, type: SYSQ.typeId, squares: SQ.makeRandomFigure(7), symmetries: SYSQ.makeSymmetryFigures(7)}\n            ]\n        },\n        {\n            practice: false,\n            problems: [\n                {id: 0, type: SYSQ.typeId, squares: SQ.makeRandomFigure(3), symmetries: SYSQ.makeSymmetryFigures(3)},\n                {id: 1, type: SYSQ.typeId, squares: SQ.makeRandomFigure(4), symmetries: SYSQ.makeSymmetryFigures(4)},\n                {id: 2, type: SYSQ.typeId, squares: SQ.makeRandomFigure(5), symmetries: SYSQ.makeSymmetryFigures(5)},\n                {id: 3, type: SYSQ.typeId, squares: SQ.makeRandomFigure(6), symmetries: SYSQ.makeSymmetryFigures(6)},\n                {id: 4, type: SYSQ.typeId, squares: SQ.makeRandomFigure(7), symmetries: SYSQ.makeSymmetryFigures(7)}\n            ]\n        }\n    ],\n    instructs: [\n        {\n            text: 'Welcome. The task you will be completing today involves two things: remembering letters and solving simple math problems. First, you will practice each part before you begin the task. Please read the instructions carefully so you know how to do the task.\\n\\nPlease click the CONTINUE button to begin',\n            next: 'Continue'\n        },\n        {\n            text: 'You will now practice remembering letters.  You will see one letter at a time presented and your goal is to remember the letters in the exact order that they appeared on the screen. After a set of letters is presented, you will see a screen with 12 possible letters.  You will click on each letter in the order you think they were presented to you. A number will appear next to the letter to indicate its position. For example, 1 will appear for the first letter, a 2 for the second letter and so on. If you need to change or adjust the order of the letters, please use the CLEAR button.\\n\\nOnce you think you have all the letters in the correct order, click CONTINUE to see the next set of letters.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        {\n        \n            text: 'You have completed the practice.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        { //5\n            text: 'You will now practice solving the simple math problems. You will see a math problem such as (2x2) + 3 = 5? Presented on the screen. Your goal is solve the problem and indicate whether the number after the = sign is true or false. In this example, (2x2) + 3 does not equal 5, so you would click the FALSE button.\\n\\nAfter you click on the TRUE or FALSE button, you will see whether your answer was correct or incorrect. Your goal is to solve each problem correctly as quickly as you can.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        { //7\n        \n            text: 'You have completed the practice.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        { //8\n            text: 'You will now practice remembering letters and solving math problems together. This practice will prepare you to complete the task and it will be more challenging than doing each part alone.\\n\\nFirst you will see a math problem to solve it by clicking on TRUE or FALSE. Next, you will see a letter. You will need to remember the letter. You will see several math problem and letter combinations in a set. After a set, you will be presented with 12 letters on the screen. As before, you will click on each letter in the order you believe they appeared on the screen.\\n\\nWe will keep track of your responses. If you take too long to respond to the math problem, the task will move on to the next letter and your math will be marked as incorrect. If you answer several incorrect math problems, you will receive a message that you have too many math errors.\\n\\nYour goal is to solve the math problem correctly as quickly as possible AND remember each of the letters in the exact order they appeared on the screen.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        { //10\n            text: 'You have completed the practice session. You are now ready to complete the task.\\n\\nYour goal is to solve the math problem correctly as quickly as possible AND remember each of the letters in the exact order they appeared on the screen.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        { //11\n            text: 'You are now ready to begin the task.\\n\\nYour goal is to solve the math problem correctly as quickly as possible AND remember each of the letters in the exact order they appeared on the screen.\\n\\nThe task can be challenging, and we ask you to try to do your best.\\n\\nPlease click START to move to next part of the task.',\n            next: 'Start'\n        },\n        {\n            text: 'Welcome. The task you will be completing today involves two things: remembering the location of blue squares on the screen and solving simple symmetry problems. First, you will practice each part before you begin the task. Please read the instructions carefully so you know how to do the task.\\n\\nPlease click the CONTINUE button to begin.',\n            next: 'Continue'\n        },\n        {\n            text: 'You will now practice remembering the position of blue squares.  You will see one blue square appear at a time in a 4x4 grid and your goal is to remember the location of the squares in the exact order that they appeared on the screen. After a set of blue squares is presented, you will see a screen with the 4x4 grid with 16 possible square positions.  You will click on each position on the grid in the order you think the blue squares were presented to you. A number will appear in the grid to mark the position. For example, 1 will appear for the first grid position you click, a 2 for the second grid position and so on. If you need to change or adjust the order of the blue squares, please use the CLEAR button.\\n\\nOnce you think you have all the blue squares in the correct order, click to the CONTINUE screen to see the next set of blue squares.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        {\n            text: 'You have completed the practice.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        {\n            text: 'You will now practice solving the simple symmetry problems. You will see a grid with black squares filled in on the screen. Imagine that there is a vertical line (top to bottom) in the center of the grid. Your task is to indicate whether the black blocks on the left and right side of this imaginary line are identical in position. If the two sides are the same, click on TRUE and if the two sides are different, click on FALSE.\\n\\nAfter you click on the TRUE or FALSE button, you will see whether your answer was correct or incorrect. Your goal is to solve each problem correctly as quickly as you can.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        {\n            text: 'You have completed the practice.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        {\n            text: 'You will now practice remembering the position of blue squares and solving symmetry problems together. This practice will prepare you to complete the task and it will be more challenging than doing each part alone.\\n\\nFirst you will see a symmetry problem to solve whether the two sides are identical by clicking on TRUE or FALSE. Next, you will see a blue square on the grid. You will need to remember the position of the blue square. You will see several symmetry problem and blue square combinations in a set. After a set, you will see a blank 4x4 grid with 16 possible square positions.  As before, you will click on each position on the grid in the order you think the blue squares were presented to you.\\n\\nWe will keep track of your responses. If you take too long to respond to the symmetry problem, the task will move on to the next blue square and your response will be marked as incorrect. If you answer several incorrect symmetry problems, you will receive a message that you have too many errors.\\n\\nYour goal is to solve the symmetry problem correctly as quickly as possible AND remember each of the blue squares in the exact order they appeared on the screen.\\n\\nPlease click the START button to begin.',\n            next: 'Start'\n        },\n        {\n            text: 'You have completed the practice of symmetry and blue squares. You are now ready to complete the task.\\n\\nYour goal is to solve the symmetry problem correctly as quickly as possible AND remember each of the blue squares in the exact order they appeared on the screen.\\n\\nPlease click CONTINUE to move to next part of the task.',\n            next: 'Continue'\n        },\n        {\n            text: 'You are now ready to begin the task.\\n\\nYour goal is to solve the symmetry problem correctly as quickly as possible AND remember each of the blue squares in the exact order they appeared on the screen.\\n\\nThe task can be challenging, and we ask you to try to do your best.\\n\\nPlease click START to move to next part of the task.',\n            next: 'Start'\n        }\n    ],\n    struct: [\n        {type: 'inst',  id: 0},//ospan\n        {type: 'inst',  id: 1},\n        {type: 'block', id: 0},\n        {type: 'inst',  id: 2},\n        {type: 'inst',  id: 3},\n        {type: 'block', id: 1},\n        {type: 'inst',  id: 4},\n        {type: 'inst',  id: 5},\n        {type: 'block', id: 2},\n        {type: 'inst',  id: 6},\n        {type: 'inst',  id: 7},\n        {type: 'block', id: 3},\n        {type: 'block', id: 4},\n        {type: 'inst',  id: 8},//sspan\n        {type: 'inst',  id: 9},\n        {type: 'block', id: 5},\n        {type: 'inst',  id: 10},\n        {type: 'inst',  id: 11},\n        {type: 'block', id: 6},\n        {type: 'inst',  id: 12},\n        {type: 'inst',  id: 13},\n        {type: 'block', id: 7},\n        {type: 'inst',  id: 14},\n        {type: 'inst',  id: 15},\n        {type: 'block', id: 8},\n        {type: 'block', id: 9}\n    ]\n};","var CreateTask = React.createClass({\n    statics: {\n        editMode: {add: 0, edit: 1}\n    },\n    getInitialState: function() {\n        // var task;\n        // if(taskType == 'ospan')\n        //     task = taskTemplate.ospan;\n        // else if(taskType == 'sspan')\n        //     task = taskTemplate.sspan;\n        // else\n        //     task = taskTemplate.combined;\n        \n        return {\n            // task: task,\n            //Edit problem context {mode, prob, blockId, probId, subId, ssubId}\n            editContext: {mode: CreateTask.editMode.add}\n        };\n    },\n    onBlockAdd: function(type) {\n        this.state.task.blocks.push({practice: (type === 'prac'), problems:[]});\n        this.state.task.struct.push({type: 'block', id: this.state.task.blocks.length - 1});\n        this.setState({task: this.state.task});\n    },\n    onBlockDel: function(blockId) {\n        console.log('onBlockDel', blockId);\n        this.state.task.blocks.splice(blockId, 1);\n\n        //Find the entry in task.struct to remove\n        var i = 0;\n        for(; i < this.state.task.struct.length; i++)\n            if(this.state.task.struct[i].id == blockId && this.state.task.struct[i].type == 'block')\n                break;\n\n        //Remove an entry from task.struct\n        this.state.task.struct.splice(i, 1);\n\n        //Adjust inst id of remaining instruct in struct\n        for(var i = 0; i < this.state.task.struct.length; i++)\n            if(this.state.task.struct[i].type == 'block' && this.state.task.struct[i].id > blockId)\n                this.state.task.struct[i].id--;\n\n        this.setState({task: this.state.task});\n    },\n    /**\n     * @param mode integer One of values of editMode.\n     * @param blockId integer Position of the block.\n     * @param probId integer Position of the problem in the block.\n     * @param subid integer  Sub id\n     * @param ssubid integer Sub-sub id\n     */\n    showProbForm: function(mode, blockId, probId, subId, ssubId) {\n        console.log(blockId,probId,subId,ssubId);\n        if(mode == CreateTask.editMode.add) {\n            this.setState({editContext:{mode: CreateTask.editMode.add, blockId: blockId}});\n            $(ProbForm.domIdSel).modal('show');\n        }\n        else {\n            var block = this.state.task.blocks[blockId];\n            var prob = block.problems[probId];\n            var ec = {\n                mode: CreateTask.editMode.edit,\n                blockId: blockId,\n                probId: probId,\n                subId: subId,\n                ssubId: ssubId\n            };\n\n            switch(prob.type) {\n                case EQLS.typeId:\n                    prob = subId == 0 ? {type: LS.typeId, letters: prob.letters} : {type: EQ.typeId, equation: prob.equations[ssubId]};\n                    break;\n                case SYSQ.typeId:\n                    prob = subId == 0 ? {type: SQ.typeId, squares: prob.squares} : {type: SY.typeId, symmetry: prob.symmetries[ssubId]};\n                    break;\n            }\n\n            ec.prob = prob;\n\n            this.setState({editContext: ec});\n            $(ProbForm.domIdSel).modal('show');\n        }\n    },\n    onAddProbClick: function(blockId) {\n        this.showProbForm(CreateTask.editMode.add, blockId);\n    },\n    onProbEdit: function(blockId, probId, subId, ssubId) {\n        this.showProbForm(CreateTask.editMode.edit, blockId, probId, subId, ssubId);\n    },\n    onProbDel: function(blockId, probId) {\n        var block = this.state.task.blocks[blockId];\n        block.problems.splice(probId, 1);\n        for(var i = 0; i < block.problems.length; i++)\n            block.problems[i].id = i;\n        this.setState({task:this.state.task});\n    },\n    onProbFormSave: function() {\n        if(this.state.editContext.mode === CreateTask.editMode.add)\n            this.probFormSaveNew();\n        else\n            this.probFormSaveEdit();  \n    },\n    probFormSaveNew: function() {\n        var type = $(ProbForm.domIdSel + ' #probType').val();\n        switch(type) {\n            case LS.typeId:\n                return this.probFormSaveNewLS();\n            case EQ.typeId:\n                return this.probFormSaveNewEQ();\n            case EQLS.typeId:\n                return this.probFormSaveNewEQLS();\n            case SQ.typeId:\n                return this.probFormSaveNewSQ();\n            case SY.typeId:\n                return this.probFormSaveNewSY();\n            case SYSQ.typeId:\n                return this.probFormSaveNewSYSQ();\n        }\n    },\n    probFormSaveNewLS: function() {\n        var str = $(ProbForm.domIdSel + ' #letters').val().trim();\n\n        if(str && str.length > 0) {\n            var a = str.split(',').map(function(str){return str.trim()}),\n                i = this.state.editContext.blockId;\n\n            this.state.task.blocks[i].problems.push({\n                id: this.state.task.blocks[i].problems.length,\n                type: LS.typeId,\n                letters: a\n            });\n\n            this.setState({task: this.state.task});\n            $(ProbForm.domIdSel).modal('hide');\n        }\n    },\n    probFormSaveNewEQ: function() {\n        var eq = $(ProbForm.domIdSel + ' #equation').val().trim();\n\n        if(EQ.isValid(eq)) {\n            var i = this.state.editContext.blockId;\n\n            this.state.task.blocks[i].problems.push({\n                id: this.state.task.blocks[i].problems.length,\n                type: EQ.typeId,\n                equation: eq\n            });\n\n            this.setState({task: this.state.task});\n            $(ProbForm.domIdSel).modal('hide');\n        }\n    },\n    probFormSaveNewEQLS: function() {\n        var eqStr = $(ProbForm.domIdSel + ' #equations').val().trim();\n        var leStr = $(ProbForm.domIdSel + ' #letters').val().trim();\n\n        if(eqStr && leStr) {\n            var eq = eqStr.split(',').map(function(str){return str.trim()});\n            var le = leStr.split(',').map(function(str){return str.trim()});\n\n            if(eq && eq.length > 0 && le && le.length > 0 && eq.length == le.length) {\n                var i = this.state.editContext.blockId;\n                this.state.task.blocks[i].problems.push({\n                    id: this.state.task.blocks[i].problems.length,\n                    type: EQLS.typeId,\n                    letters: le,\n                    equations: eq\n                });\n                this.setState({blocks: this.state.task.blocks});\n                $(ProbForm.domIdSel).modal('hide');\n            }\n        }\n    },\n    probFormSaveNewSQ: function() {\n        var editContext = this.state.editContext;\n        var blockId = editContext.blockId;\n        var json = $(ProbForm.domIdSel + ' #squares').val().trim();\n        this.state.task.blocks[blockId].problems.push({\n            id: this.state.task.blocks[blockId].problems.length,\n            type: SQ.typeId,\n            squares: JSON.parse(json)\n        });\n        this.setState({task: this.state.task});\n        $(ProbForm.domIdSel).modal('hide');\n    },\n    probFormSaveNewSY: function(){\n        var editContext = this.state.editContext;\n        var blockId = editContext.blockId;\n        var json = $(ProbForm.domIdSel + ' #symmetry').val().trim();\n        this.state.task.blocks[blockId].problems.push({\n            id: this.state.task.blocks[blockId].problems.length,\n            type: SY.typeId,\n            symmetry: JSON.parse(json)\n        });\n        this.setState({task: this.state.task});\n        $(ProbForm.domIdSel).modal('hide');\n    },\n    probFormSaveNewSYSQ: function() {\n        var length = $(ProbForm.domIdSel + ' #length').val().trim();\n        var blockId = this.state.editContext.blockId;\n\n        if(length && /^\\d+$/.test(length)) {\n            length = parseInt(length);\n            \n            this.state.task.blocks[blockId].problems.push({\n                id: this.state.task.blocks[blockId].problems.length,\n                type: SYSQ.typeId,\n                squares: SQ.makeRandomFigure(length),\n                symmetries: SYSQ.makeSymmetryFigures(length)\n            });\n\n            this.setState({task: this.state.task});\n            $(ProbForm.domIdSel).modal('hide');\n        }\n    },\n    probFormSaveEdit: function() {\n        var editContext = this.state.editContext;\n        var block = this.state.task.blocks[editContext.blockId];\n        var prob = block.problems[editContext.probId];\n\n        switch(prob.type) {\n            case LS.typeId:\n                return this.probFormSaveEditLS();\n            case EQ.typeId:\n                return this.probFormSaveEditEQ();\n            case EQLS.typeId:\n                return this.probFormSaveEditEQLS();\n            case SQ.typeId:\n                return this.probFormSaveEditSQ();\n            case SY.typeId:\n                return this.probFormSaveEditSY();\n            case SYSQ.typeId:\n                return this.probFormSaveEditSYSQ();\n        }\n    },\n    probFormSaveEditLS: function() {\n        var editContext = this.state.editContext;\n        var blockId = editContext.blockId;\n        var probId = editContext.probId;\n\n        var str = $(ProbForm.domIdSel + ' #letters').val().trim();\n        \n        if(str && str.length > 0) {\n            var a = str.split(',').map(function(str){return str.trim()});\n            if(a.length > 0) {\n                this.state.task.blocks[blockId].problems[probId].letters = a;\n                this.setState({task: this.state.task});\n                $(ProbForm.domIdSel).modal('hide');\n            }\n        }\n    },\n    probFormSaveEditEQ: function() {\n        var editContext = this.state.editContext;\n        var blockId = editContext.blockId;\n        var probId = editContext.probId;\n        var equation = $(ProbForm.domIdSel + ' #equation').val().trim();\n\n        if(EQ.isValid(equation)) {\n            this.state.task.blocks[blockId].problems[probId].equation = equation;\n            this.setState({task: this.state.task});\n            $(ProbForm.domIdSel).modal('hide');\n        }\n    },\n    probFormSaveEditEQLS: function() {\n        var editContext = this.state.editContext;\n        var blockId = editContext.blockId;\n        var probId = editContext.probId;\n        var subId = editContext.subId;\n        var ssubId = editContext.ssubId;\n\n        //This feature is currently not supported, so we just return.\n        if(subId == null || subId == undefined) return;\n\n        //Edit letters\n        if(subId == 0) {\n            this.probFormSaveEditLS();\n        }\n        //Edit one of the equations\n        else if(subId == 1) {\n            var equation = $(ProbForm.domIdSel + ' #equation').val().trim();\n\n            if(EQ.isValid(equation)) {\n                this.state.task.blocks[blockId].problems[probId].equations[ssubId] = equation;\n                this.setState({task: this.state.task});\n                $(ProbForm.domIdSel).modal('hide');\n            }\n        }\n    },\n    probFormSaveEditSQ: function() {\n        var editContext = this.state.editContext;\n        var blockId = editContext.blockId;\n        var probId = editContext.probId;\n        var json = $(ProbForm.domIdSel + ' #squares').val().trim();\n        this.state.task.blocks[blockId].problems[probId].squares = JSON.parse(json);\n        this.setState({task: this.state.task});\n        $(ProbForm.domIdSel).modal('hide');\n    },\n    probFormSaveEditSY: function() {\n        var editContext = this.state.editContext;\n        var blockId = editContext.blockId;\n        var probId = editContext.probId;\n        var json = $(ProbForm.domIdSel + ' #symmetry').val().trim();\n        this.state.task.blocks[blockId].problems[probId].symmetry = JSON.parse(json);\n        this.setState({task: this.state.task});\n        $(ProbForm.domIdSel).modal('hide');\n    },\n    probFormSaveEditSYSQ: function() {\n        var editContext = this.state.editContext;\n        var blockId = editContext.blockId;\n        var probId = editContext.probId;\n        var subId = editContext.subId;\n        var ssubId = editContext.ssubId;\n\n        //This feature is currently not supported, so we just return.\n        if(subId == null || subId == undefined) return;\n\n        //Edit squares\n        if(subId == 0) {\n            this.probFormSaveEditSQ();\n        }\n        //Edit one of the equations\n        else if(subId == 1) {\n            var symmetry = $(ProbForm.domIdSel + ' #symmetry').val().trim();\n            this.state.task.blocks[blockId].problems[probId].symmetries[ssubId] = JSON.parse(symmetry);\n            this.setState({task: this.state.task});\n            $(ProbForm.domIdSel).modal('hide');\n            \n        }\n    },\n    onTaskSave: function() {\n        if(this.validateTask()) {\n            $.ajax({\n                type: 'POST',\n                url: taskSaveUrl,\n                contentType: 'application/json',\n                data: {\n                    name: this.refs.taskName.refs.input.getDOMNode().value.trim(),\n                    task: JSON.stringify(this.state.task),\n                    maxScore: TSK.getMaxScore(this.state.task)\n                },\n                success: function(data, textStatus, jqXHR) {\n                    // console.log('Ajax save success', textStatus, data);\n                    console.log(data);\n                    // window.location.href = taskIndexUrl;\n                },\n                error: function(jqXHR, textStatus, errorThrown) {\n                    console.log('Ajax save error', textStatus, errorThrown);\n                }\n            });\n        }\n    },\n    validateTask: function() {\n        //Reset error message\n        this.setState({error: null});\n\n        //Validate that name is not empty\n        var name = this.refs.taskName.refs.input.getDOMNode().value.trim();\n        if(!name || name == '') {\n            this.setState({error: 'Task name is empty'});\n            return false;\n        }\n\n        //Validate that every block has problem\n        for(var i = 0; i < this.state.task.blocks.length; i++) {\n            if(this.state.task.blocks[i].problems.length == 0) {\n                this.setState({error: 'Block ' + (i + 1) + ' is empty'});\n                return false;\n            }\n        }\n\n        return true;\n    },\n    onInstAdd: function() {\n        console.log('onInstAdd');\n        this.setState({editContext:{}});\n        $(InstForm.domIdSel).modal('show');\n    },\n    onInstEdit: function(instId) {\n        console.log('onInstEdit', instId);\n        this.setState({editContext:{inst: this.state.task.instructs[instId]}});\n        $(InstForm.domIdSel).modal('show');\n    },\n    onInstDel: function(instId) {\n        //Remove the inst entry\n        this.state.task.instructs.splice(instId, 1);\n        \n        //Find the entry in task.struct to remove\n        var i = 0;\n        for(; i < this.state.task.struct.length; i++)\n            if(this.state.task.struct[i].id == instId && this.state.task.struct[i].type == 'inst')\n                break;\n\n        //Remove an entry from task.struct\n        this.state.task.struct.splice(i, 1);\n\n        //Adjust inst id of remaining instruct in struct\n        for(var i = 0; i < this.state.task.struct.length; i++)\n            if(this.state.task.struct[i].type == 'inst' && this.state.task.struct[i].id > instId)\n                this.state.task.struct[i].id--;\n\n        this.setState({task: this.state.task});\n    },\n    onInstFormSave: function() {\n        var text = this.refs.instForm.refs.body.refs.text.getDOMNode().value.trim();\n        var next = this.refs.instForm.refs.body.refs.next.getDOMNode().value.trim();\n\n        if(text == '' || next == '') return;\n\n        //Editing existing instruction\n        if(this.state.editContext.inst) {\n            this.state.editContext.inst.text = text;\n            this.state.editContext.inst.next = next;\n            this.setState({task: this.state.task});\n        }\n        //Adding new instruction\n        else {\n            var inst = {text: text, next: next}\n            var instId = this.state.task.instructs.length;\n\n            this.state.task.instructs.push(inst);\n            this.state.task.struct.push({type: 'inst', id: instId});\n            this.setState({task: this.state.task});\n        }\n\n        $(InstForm.domIdSel).modal('hide');\n    },\n    render: function() {\n        return (\n            <div>\n                {/*<CreateTask.TaskNameInput ref=\"taskName\"/>*/}\n                {/*<TaskObList task={this.state.task} onAddProbClick={this.onAddProbClick} onProbEdit={this.onProbEdit} onProbDel={this.onProbDel} onBlockDel={this.onBlockDel} onInstEdit={this.onInstEdit} onInstDel={this.onInstDel}/>*/}\n                {/*<CreateTask.Buttons onBlockAdd={this.onBlockAdd} onInstAdd={this.onInstAdd}/>*/}\n                {/*<CreateTask.Error error={this.state.error}/>*/}\n                {/*<CreateTask.SaveRow onTaskSave={this.onTaskSave}/>*/}\n                <ProbForm editContext={this.state.editContext} onSaveClick={this.onProbFormSave}/>\n                {/*<InstForm ref=\"instForm\" editContext={this.state.editContext} onSaveClick={this.onInstFormSave}/>*/}\n            </div>\n        );\n    }\n    // render: function() {\n    //     return (\n    //         <div>\n    //             <ProbForm editContext={this.state.editContext} onSaveClick={this.onProbFormSave}/>\n    //         </div>\n    //     );\n    // }\n});\n\nCreateTask.TaskNameInput = React.createClass({\n    render: function() {\n        return (\n            <form>\n                <div className=\"form-group\">\n                    <label htmlFor=\"taskName\">Task Name</label>\n                    <input ref=\"input\" id=\"taskName\" className=\"form-control\"/>\n                </div>\n            </form>\n        )\n    }\n});\n\nCreateTask.Error = React.createClass({\n    propTypes: {\n        error: React.PropTypes.string\n    },\n    render: function() {\n        if(!this.props.error || this.props.error == '')\n            return null;\n        return <div className=\"alert alert-danger\" role=\"alert\">{this.props.error}</div>\n    }\n});\n\nCreateTask.Buttons = React.createClass({\n    propTypes: {\n        onBlockAdd: React.PropTypes.func.isRequired,\n        onInstAdd: React.PropTypes.func.isRequired\n    },\n    onAddTaskBlock: function() {\n        this.props.onBlockAdd('task');\n    },\n    onAddPracBlock: function() {\n        this.props.onBlockAdd('prac');\n    },\n    render: function() {\n        return (\n            <div style={{marginBottom:10}}>\n                <button className=\"btn btn-default\" onClick={this.onAddTaskBlock}>New Task Block</button> <button className=\"btn btn-default\" onClick={this.onAddPracBlock}>New Practice Block</button> <button className=\"btn btn-default\" onClick={this.props.onInstAdd}>New Instruction</button>\n            </div>\n        );\n    }\n});\n\nCreateTask.SaveRow = React.createClass({\n    propTypes: {\n        onTaskSave: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        return (\n            <div style={{marginTop:10}}>\n                <button className=\"btn btn-default\" onClick={this.props.onTaskSave}>Finish</button>\n            </div>\n        )\n    }\n});\n\nvar TaskObList = React.createClass({\n    propTypes: {\n        task: React.PropTypes.object.isRequired,\n        onAddProbClick: React.PropTypes.func.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired,\n        onProbDel: React.PropTypes.func.isRequired,\n        onBlockDel: React.PropTypes.func.isRequired,\n        onInstEdit: React.PropTypes.func.isRequired,\n        onInstDel: React.PropTypes.func.isRequired,\n        mode: React.PropTypes.string\n    },\n    getDefaultProps: function() {\n        return {\n            mode: 'edit'\n        };\n    },\n    render: function() {\n        var comps = this.props.task.struct.map(function(desc, i) {\n            if(desc.type === 'inst')\n                return <TaskObList.Inst key={i} instId={desc.id} inst={this.props.task.instructs[desc.id]} mode={this.props.mode} onInstEdit={this.props.onInstEdit} onInstDel={this.props.onInstDel}/>\n            else if(desc.type === 'block')\n                return <Block key={i} blockId={desc.id} block={this.props.task.blocks[desc.id]} mode={this.props.mode} onAddProbClick={this.props.onAddProbClick} onProbEdit={this.props.onProbEdit} onProbDel={this.props.onProbDel} onBlockDel={this.props.onBlockDel}/>\n        }.bind(this));\n\n        return <div>{comps}</div>\n    }\n});\n\nTaskObList.Inst = React.createClass({\n    propTypes: {\n        instId: React.PropTypes.number.isRequired,\n        inst: React.PropTypes.object.isRequired,\n        onInstEdit: React.PropTypes.func.isRequired,\n        onInstDel: React.PropTypes.func.isRequired,\n        mode: React.PropTypes.string.isRequired\n    },\n    onInstEdit: function() {\n        this.props.onInstEdit(this.props.instId);\n    },\n    onInstDel: function() {\n        this.props.onInstDel(this.props.instId);\n    },\n    render: function() {\n        return (\n            <div className=\"panel panel-default\">\n                <div className=\"panel-heading\">\n                    <table border=\"0\" cellSpacing=\"0\" cellPadding=\"0\" width=\"100%\">\n                        <tr>\n                            <td>\n                                <h2 className=\"panel-title\">Instruction</h2>\n                            </td>\n                            {\n                                this.props.mode === 'edit' ?\n                                    <td style={{width:35}}>\n                                        <button type=\"button\" className=\"close\" aria-label=\"Close\" onClick={this.onInstDel}>\n                                            <span aria-hidden=\"true\">&times;</span>\n                                        </button>\n                                    </td>\n                                :\n                                null\n                            }\n                        </tr>\n                    </table>\n                </div>\n                <div className=\"panel-body\" onClick={this.onInstEdit}>\n                    <span dangerouslySetInnerHTML={{__html:marked(this.props.inst.text)}}/> <kbd>{this.props.inst.next}</kbd>\n                </div>\n            </div>\n        )\n    }\n});\n\nvar Block = React.createClass({\n    propTypes: {\n        blockId: React.PropTypes.number.isRequired,\n        block: React.PropTypes.object.isRequired,\n        onAddProbClick: React.PropTypes.func.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired,\n        onProbDel: React.PropTypes.func.isRequired,\n        mode: React.PropTypes.string.isRequired\n    },\n    onProbEdit: function(blockId, probId, subId, ssubId) {\n        this.props.onProbEdit(this.props.blockId, probId, subId, ssubId);\n    },\n    onBlockDel: function() {\n        this.props.onBlockDel(this.props.blockId);\n\n    },\n    render: function() {\n        return (\n            <div className=\"panel panel-default\">\n                <Block.Heading blockId={this.props.blockId} block={this.props.block} onBlockDel={this.onBlockDel} mode={this.props.mode}/>\n                <Block.Body blockId={this.props.blockId} block={this.props.block} onProbEdit={this.onProbEdit} onProbDel={this.props.onProbDel}/>\n                {this.props.mode === 'edit' ? <Block.Footer blockId={this.props.blockId} onAddProbClick={this.props.onAddProbClick}/> : null }\n            </div>\n        )\n    }\n});\n\n\nBlock.Heading = React.createClass({\n    propTypes: {\n        blockId: React.PropTypes.number.isRequired,\n        block: React.PropTypes.object.isRequired,\n        mode: React.PropTypes.string.isRequired,\n        onBlockDel: React.PropTypes.func\n    },\n    render: function() {\n        return (\n            <div className=\"panel-heading\">\n                <table border=\"0\" cellPadding=\"0\" cellSpacing=\"0\" width=\"100%\">\n                    <tr>\n                        <td>\n                            <h2 className=\"panel-title\">Block {this.props.blockId + 1} {this.props.block.practice ? '(Practice)' : '(Non-Practice)'}</h2>\n                        </td>\n                        <td>\n                        {\n                            this.props.mode === 'edit' ?\n                                <button type=\"button\" className=\"close\" aria-label=\"Close\" onClick={this.props.onBlockDel}><span aria-hidden=\"true\">&times;</span></button> : null\n                        }\n                        </td>\n                    </tr>\n                </table>\n            </div>\n        )\n    }\n});\n\nBlock.Body = React.createClass({\n    propTypes: {\n        blockId: React.PropTypes.number.isRequired,\n        block: React.PropTypes.object.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired,\n        onProbDel: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        var res = this.props.block.problems.length > 0 ?\n            <Block.Table blockId={this.props.blockId} block={this.props.block} onProbEdit={this.props.onProbEdit} onProbDel={this.props.onProbDel} /> :\n            <div className=\"panel-body\">There is currently no problem in this block.</div>\n        return res;\n    }\n});\n\nBlock.Table = React.createClass({\n    propTypes: {\n        blockId: React.PropTypes.number.isRequired,\n        block: React.PropTypes.object.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired,\n        onProbDel: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        return (\n            <table className=\"table\">\n                <tbody>\n                    {this.props.block.problems.map(function(p, i){\n                        return <Block.Table.Row key={i} blockId={this.props.blockId} problem={p} onProbEdit={this.props.onProbEdit} onProbDel={this.props.onProbDel}/>\n                    }.bind(this))}\n                </tbody>\n            </table>\n        )\n    }\n});\n\nBlock.Table.Row = React.createClass({\n    propTypes: {\n        blockId: React.PropTypes.number.isRequired,\n        problem: React.PropTypes.object.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired,\n        onProbDel: React.PropTypes.func.isRequired\n    },\n    onProbEdit: function(blockId, probId, subId, ssubId) {\n        this.props.onProbEdit(null, this.props.problem.id, subId, ssubId);\n    },\n    onProbDel: function() {\n        this.props.onProbDel(this.props.blockId, this.props.problem.id);\n    },\n    render: function() {\n        return (\n            <tr>\n                <td style={{width:50}}>{this.props.problem.id + 1}</td>\n                <td style={{width:140}}>{this.getProblemTypeName(this.props.problem)}</td>\n                <td>{this.getProblemWidget()}</td>\n                <td>\n                    <button type=\"button\" className=\"close pull-right\" aria-label=\"Close\" onClick={this.onProbDel}><span aria-hidden=\"true\">&times;</span></button>\n                </td>\n            </tr>\n        )\n    },\n    getProblemTypeName: function(problem) {\n        switch(this.props.problem.type) {\n            case EQ.typeId: return EQ.typeLabel\n            case LS.typeId: return LS.typeLabel\n            case EQLS.typeId: return EQLS.typeLabel\n            case SQ.typeId: return SQ.typeLabel\n            case SY.typeId: return SY.typeLabel\n            case SYSQ.typeId: return SYSQ.typeLabel\n        }\n    },\n    getProblemWidget: function() {\n        switch(this.props.problem.type) {\n            case EQ.typeId:\n                return <Block.Table.Row.MathWidget onProbEdit={this.onProbEdit} equation={this.props.problem.equation} />\n            case LS.typeId:\n                return <Block.Table.Row.LettersWidget onProbEdit={this.onProbEdit} letters={this.props.problem.letters} />\n            case EQLS.typeId:\n                return <Block.Table.Row.MathLetterWidget onProbEdit={this.onProbEdit} equations={this.props.problem.equations} letters={this.props.problem.letters}/>\n            case SQ.typeId:\n                return <Block.Table.Row.SquaresWidget squares={this.props.problem.squares} onProbEdit={this.onProbEdit}/>\n            case SY.typeId:\n                return <Block.Table.Row.SymmetryWidget symmetry={this.props.problem.symmetry} onProbEdit={this.onProbEdit}/>\n            case SYSQ.typeId:\n                return <Block.Table.Row.SymmetrySquaresWidget squares={this.props.problem.squares} symmetries={this.props.problem.symmetries} onProbEdit={this.onProbEdit}/>\n        }\n    }\n});\n\nBlock.Table.Row.MathWidget = React.createClass({\n    propTypes: {\n        equation: React.PropTypes.string.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        return <span className=\"inline-item\" style={{cursor:'pointer'}} onClick={this.props.onProbEdit.bind(null, null, null, null, null)}>{this.props.equation}, {EQ.getAnswer(this.props.equation).toString()}</span>\n    }\n});\n\nBlock.Table.Row.LettersWidget = React.createClass({\n    propTypes: {\n        letters: React.PropTypes.array.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        var str = this.props.letters.toString().replace(/,/g, ', ');\n        return <span className=\"inline-item\" style={{cursor:'pointer'}} onClick={this.props.onProbEdit.bind(null, null, null, null, null)}>{str}</span>\n    }\n});\n\nBlock.Table.Row.MathLetterWidget = React.createClass({\n    propTypes: {\n        equations: React.PropTypes.array.isRequired,\n        letters: React.PropTypes.array.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        var lc = <Block.Table.Row.LettersWidget letters={this.props.letters} onProbEdit={this.props.onProbEdit.bind(null, null, null, 0, null)}/>\n\n        var ec = this.props.equations.map(function(equation, i) {\n            return <Block.Table.Row.MathWidget key={i} equation={equation} onProbEdit={this.props.onProbEdit.bind(null, null, null, 1, i)}/>\n        }.bind(this));\n\n        return (\n            <div>\n                {lc}{ec}\n            </div>\n        )\n    }\n});\n\nBlock.Table.Row.SquaresWidget = React.createClass({\n    propTypes: {\n        squares: React.PropTypes.array.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        return <Block.Table.Row.SquaresWidget.Figure squares={this.props.squares} onProbEdit={this.props.onProbEdit}/>\n    }\n});\n\nBlock.Table.Row.SquaresWidget.Figure = React.createClass({\n    propTypes: {\n        squares: React.PropTypes.array.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired\n    },\n    onClick: function() {\n        this.props.onProbEdit(null, null, null, null);\n    },\n    render: function() {\n        var text = this.props.squares.map(function(cell, i){\n            return {loc: cell, text: i + 1};\n        });\n\n        return (\n            <div style={{display:'inline-block', width:100, marginRight:15}}>\n                <BoxSequence.Slide.Figure class=\"row-figure\" rows={4} cols={4} cellText={text} onCellClick={this.onClick}/>\n            </div>\n        );\n    }\n});\n\nBlock.Table.Row.SymmetryWidget = React.createClass({\n    propTypes: {\n        symmetry: React.PropTypes.array.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        return <Block.Table.Row.SymmetryWidget.Figure symmetry={this.props.symmetry} onProbEdit={this.props.onProbEdit}/>\n    }\n});\n\nBlock.Table.Row.SymmetryWidget.Figure = React.createClass({\n    propTypes: {\n        symmetry: React.PropTypes.array.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired\n    },\n    onClick: function() {\n        this.props.onProbEdit(null, null, null, null);\n    },\n    render: function() {\n        return (\n            <div style={{display:'inline-block', width:100, marginRight:15, marginBottom:8, marginTop:8}}>\n                <BoxSequence.Slide.Figure class=\"row-figure\" rows={8} cols={8} colored={this.props.symmetry} borderColor={'#000'} hiColor={'#000'} onCellClick={this.onClick}/>\n                <div style={{textAlign:'center', width:'100%', fontSize:12}}>{SY.isSymmetric(this.props.symmetry) ? 'Symmetric' : 'Asymmetric'}</div>\n            </div>\n        );\n    }\n});\n\nBlock.Table.Row.SymmetrySquaresWidget = React.createClass({\n    propTypes: {\n        squares: React.PropTypes.array.isRequired,\n        symmetries: React.PropTypes.array.isRequired,\n        onProbEdit: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        var squares = <Block.Table.Row.SquaresWidget.Figure squares={this.props.squares} onProbEdit={this.props.onProbEdit.bind(null, null, null, 0, null)}/>\n\n        var symmetries = this.props.symmetries.map(function(symmetry, i) {\n            return <Block.Table.Row.SymmetryWidget.Figure key={i} symmetry={symmetry} onProbEdit={this.props.onProbEdit.bind(null, null, null, 1, i)}/>\n        }.bind(this));\n\n        return (\n            <div>\n                <div style={{display:'inline-block'}}>{squares}<div dangerouslySetInnerHTML={{__html: '&nbsp;'}}/></div>\n                {symmetries}\n            </div>\n        );\n    }\n});\n\nBlock.Footer = React.createClass({\n    propTypes: {\n        blockId: React.PropTypes.number.isRequired,\n        onAddProbClick: React.PropTypes.func.isRequired\n    },\n    onAddProbClick: function() {\n        this.props.onAddProbClick(this.props.blockId);\n    },\n    render: function() {\n        return (\n            <div className=\"panel-footer\">\n                <button className=\"btn btn-default\" onClick={this.onAddProbClick}>Add Problem</button>\n            </div>\n        )\n    }\n});\n\n\nvar ProbForm = React.createClass({\n    propTypes: {\n        editContext: React.PropTypes.object.isRequired,\n        onSaveClick: React.PropTypes.func.isRequired\n    },\n    statics: {\n        domId: 'probForm',\n        domIdSel: '#probForm'\n    },\n    render: function() {\n        return (\n            <div className=\"modal fade\" id={ProbForm.domId} tabIndex=\"-1\" role=\"dialog\" labelledby=\"myModalLabel\">\n                <div className=\"modal-dialog\" role=\"document\">\n                    <div className=\"modal-content\">\n                        <ProbForm.Header editContext={this.props.editContext}/>\n                        <ProbForm.Body editContext={this.props.editContext}/>\n                        <ProbForm.Footer onSaveClick={this.props.onSaveClick} />\n                    </div>\n                </div>\n            </div>\n        )\n    }\n});\n\nProbForm.Header = React.createClass({\n    propTypes: {\n        editContext: React.PropTypes.object.isRequired\n    },\n    render: function() {\n        return (\n            <div className=\"modal-header\">\n                <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                {\n                    this.props.editContext.mode === CreateTask.editMode.add ? \n                        <h4 className=\"modal-title\" id=\"myModalLabel\">New Problem</h4> :\n                        <h4 className=\"modal-title\" id=\"myModalLabel\">Edit Problem</h4>\n                }\n            </div>\n        )\n    }\n});\n\nProbForm.Body = React.createClass({\n    propTypes: {\n        editContext: React.PropTypes.object.isRequired\n    },\n    getInitialState: function() {\n        return {\n            type: LS.typeId\n        }\n    },\n    onTypeChange: function(event) {\n        this.setState({type: event.target.value});\n    },\n    render: function() {\n        return (\n            <div className=\"modal-body\">\n                <form>\n                    {\n                        this.props.editContext.mode === CreateTask.editMode.edit ? null :\n                        <div className=\"form-group\">\n                            <label htmlFor=\"probType\">Type</label>\n                            <select className=\"form-control\" id=\"probType\" value={this.state.type} onChange={this.onTypeChange}>\n                                <option value={LS.typeId}>Letter Sequence</option>\n                                <option value={EQ.typeId}>Math Equation</option>\n                                <option value={EQLS.typeId}>Math and Letters</option>\n                                <option value={SQ.typeId}>Square Sequence</option>\n                                <option value={SY.typeId}>Symmetry</option>\n                                <option value={SYSQ.typeId}>Symmetry and Squares</option>\n                            </select>\n                        </div>\n                    }\n\n                    <ProbForm.SpecialPane editContext={this.props.editContext} type={this.props.editContext.prob ? this.props.editContext.prob.type : this.state.type}/>\n                    {/*<ProbForm.SpecialPane editContext={this.props.editContext} type={SQ.typeId}/>*/}\n                </form>\n            </div>\n        )\n    }\n});\n\nProbForm.SpecialPane = React.createClass({\n    propTypes: {\n        type: React.PropTypes.string.isRequired,\n        editContext: React.PropTypes.object.isRequired\n    },\n    render: function() {\n        switch(this.props.type) {\n            case LS.typeId:\n                return <ProbForm.LSPane editContext={this.props.editContext}/>\n            case EQ.typeId:\n                return <ProbForm.EQPane editContext={this.props.editContext}/>\n            case EQLS.typeId:\n                return <ProbForm.EQLSPane/>\n            case SQ.typeId:\n                return <ProbForm.SQPane editContext={this.props.editContext}/>\n            case SY.typeId:\n                return <ProbForm.SYPane editContext={this.props.editContext}/>\n            case SYSQ.typeId:\n                return <ProbForm.SYSQPane/>\n            default:\n                return null;\n        }\n    }\n});\n\nProbForm.LSPane = React.createClass({\n    propTypes: {\n        editContext: React.PropTypes.object.isRequired\n    },\n    getInitialState: function() {\n        return {val: this.props.editContext.prob ? this.props.editContext.prob.letters : ''};\n    },\n    componentWillReceiveProps: function(nextProps) {\n        this.setState({val: nextProps.editContext.prob ? nextProps.editContext.prob.letters : ''});\n    },\n    onChange: function(event) {\n        this.setState({val: event.target.value});\n    },\n    render: function() {\n        return (\n            <div>\n                <div className=\"form-group\">\n                    <label htmlFor=\"letters\">Letters</label>\n                    <input type=\"text\" className=\"form-control\" id=\"letters\" value={this.state.val} onChange={this.onChange}/>\n                    <div>A sequence of letters. For example: <code>X,Y,Z</code></div>\n                </div>\n            </div>\n        )\n    }\n});\n\nProbForm.EQPane = React.createClass({\n    propTypes: {\n        editContext: React.PropTypes.object.isRequired\n    },\n    getInitialState: function() {\n        return {val: this.props.editContext.prob ? this.props.editContext.prob.equation : ''};\n    },\n    componentWillReceiveProps: function(nextProps) {\n        this.setState({val: nextProps.editContext.prob ? nextProps.editContext.prob.equation : ''});\n    },\n    onChange: function(event) {\n        this.setState({val: event.target.value});\n    },\n    render: function() {\n        return (\n            <div>\n                <div className=\"form-group\">\n                    <label htmlFor=\"equation\">Equation</label>\n                    <input className=\"form-control\" id=\"equation\" value={this.state.val} onChange={this.onChange}/>\n                    <div>An equation, such as <code>(2*2)+2=2</code></div>\n                </div>\n            </div>\n        )\n    }\n});\n\nProbForm.EQLSPane = React.createClass({\n    render: function() {\n        return (\n            <div>\n                <div className=\"form-group\">\n                    <label htmlFor=\"equations\">Equations</label>\n                    <textarea className=\"form-control\" id=\"equations\"></textarea>\n                    <div>Equations separated by commas <code>,</code>. For example: <code>(2*2)+2=2, (4/2)-1=1</code></div>\n                </div>\n                <div className=\"form-group\">\n                    <label htmlFor=\"letters\">Letters</label>\n                    <input type=\"text\" className=\"form-control\" id=\"letters\" />\n                    <div>A sequence of letters. For example: <code>X,Y,Z</code></div>\n                </div>\n            </div>\n        )\n    }\n});\n\nProbForm.SQPane = React.createClass({\n    propTypes: {\n        editContext: React.PropTypes.object.isRequired\n    },\n    getInitialState: function() {\n        var slots = new Array(4 * 4);\n        \n        if(this.props.editContext.prob)\n            for(var i = 0; i < this.props.editContext.prob.squares.length; i++)\n                slots[i] = this.props.editContext.prob.squares[i];\n\n        return {slots: slots};\n    },\n    componentWillReceiveProps: function(nextProps) {\n        var slots = new Array(4 * 4);\n\n        if(nextProps.editContext.prob)\n            for(var i = 0; i < nextProps.editContext.prob.squares.length; i++)\n                slots[i] = nextProps.editContext.prob.squares[i];\n\n        this.setState({slots: slots});\n    },\n    onCellClick: function(cell) {\n        var index = PointCollection.indexOf(this.state.slots, cell);\n        var slots = this.state.slots;\n\n        if(index == -1) {\n            for(var i = 0; i < slots.length; i++) {\n                if(!slots[i]) {\n                    slots[i] = cell;\n                    this.setState({slots: slots});\n                    break;\n                }\n            }\n        }\n        else {\n            slots[index] = null;\n            this.setState({slots: slots});\n        }\n    },\n    render: function() {\n        var slots = this.state.slots,\n            cellText = [],\n            trunc = [];\n\n        for(var i = 0; i < slots.length; i++)\n            cellText.push({loc: slots[i], text: i + 1});\n\n        for(var i = 0; i < slots.length; i++)\n            if(slots[i])\n                trunc.push(slots[i]);\n\n        return (\n            <div className=\"container-fluid\">\n                <div className=\"row\">\n                    <div className=\"col-xs-6 col-xs-offset-3\">\n                        <input type=\"hidden\" id=\"squares\" value={JSON.stringify(trunc)}/>\n                        <BoxSequence.Slide.Figure rows={4} cols={4} cellText={cellText} onCellClick={this.onCellClick}/>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n});\n\nProbForm.SYPane = React.createClass({\n    propTypes: {\n        editContext: React.PropTypes.object.isRequired\n    },\n    getInitialState: function() {\n        if (this.props.editContext.subType == null)\n            var colored = this.props.editContext.prob ? this.props.editContext.prob.symmetry : [];\n        else if (this.props.editContext.subType == 1)\n            var colored = this.props.editContext.prob ? this.props.editContext.prob.symmetries[this.props.editContext.key] : [];\n        return {colored: colored};\n    },\n    componentWillReceiveProps: function(nextProps) {\n        if (nextProps.editContext.subType == null)\n            var colored = nextProps.editContext.prob ? nextProps.editContext.prob.symmetry : [];\n        else if (nextProps.editContext.subType == 1)\n            var colored = nextProps.editContext.prob ? nextProps.editContext.prob.symmetries[nextProps.editContext.key] : [];\n\n        this.setState({colored: colored});\n    },\n    onCellClick: function(cell) {\n        var i = PointCollection.indexOf(this.state.colored, cell);\n        if(i == -1)\n            this.state.colored.push(cell);\n        else\n            this.state.colored.splice(i, 1);\n        this.setState({colored: this.state.colored});\n    },\n    makeSymmetric: function() {\n        this.setState({colored: SY.makeSymmetricFigure()});\n    },\n    makeAsymetric: function() {\n        switch(Math.floor(Math.random() * 2)) {\n            case 0:\n                this.setState({colored: SY.makeAsymmetricFigure()});\n            case 1:\n                this.setState({colored: SY.makeRandomFigure()});\n        }\n    },\n    render: function() {\n        return (\n            <div className=\"container-fluid\">\n                <div className=\"row\">\n                    <div className=\"col-xs-6 col-xs-offset-3\">\n                        <input type=\"hidden\" id=\"symmetry\" value={JSON.stringify(this.state.colored)}/>\n                        <BoxSequence.Slide.Figure rows={8} cols={8} colored={this.state.colored} borderColor={'#000'} hiColor={'#000'} onCellClick={this.onCellClick}/>\n                    </div>\n                </div>\n                <div className=\"row\"><div className=\"col-xs-12\"><hr/></div></div>\n                <div className=\"row\">\n                    <div className=\"col-xs-12\" style={{textAlign:'center'}}>\n                        <button type=\"button\" className=\"btn btn-default\" onClick={this.makeSymmetric}>Generate Symmetric</button> <button type=\"button\" className=\"btn btn-default\" onClick={this.makeAsymetric}>Generate Asymmetric</button>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n});\n\nProbForm.SYSQPane = React.createClass({\n    render: function() {\n        return (\n            <div className=\"form-group\">\n                <label htmlFor=\"length\">Number of Subproblems</label>\n                <input className=\"form-control\" id=\"length\" defaultValue={3}/>\n                <div>Length of square sequence and must be an integer</div>\n            </div>\n        )\n    }\n});\n\nProbForm.Footer = React.createClass({\n    propTypes: {\n        onSaveClick: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        return (\n            <div className=\"modal-footer\">\n                <button type=\"button\" className=\"btn btn-default\" data-dismiss=\"modal\">Cancel</button>\n                <button type=\"button\" className=\"btn btn-primary\" onClick={this.props.onSaveClick}>Ok</button>\n            </div>\n        )\n    }\n});\n\nvar InstForm = React.createClass({\n    propTypes: {\n        editContext: React.PropTypes.object.isRequired,\n        onSaveClick: React.PropTypes.func.isRequired\n    },\n    statics: {\n        domId: 'instForm',\n        domIdSel: '#instForm'\n    },\n    render: function() {\n        return (\n            <div className=\"modal fade\" id={InstForm.domId} tabIndex=\"-1\" role=\"dialog\">\n                <div className=\"modal-dialog\" role=\"document\">\n                    <div className=\"modal-content\">\n                        <InstForm.Header editContext={this.props.editContext}/>\n                        <InstForm.Body editContext={this.props.editContext} ref=\"body\"/>\n                        <InstForm.Footer onSaveClick={this.props.onSaveClick} />\n                    </div>\n                </div>\n            </div>\n        )\n    }\n});\n\nInstForm.Header = React.createClass({\n    propTypes: {\n        editContext: React.PropTypes.object.isRequired\n    },\n    render: function() {\n        return (\n            <div className=\"modal-header\">\n                <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                {\n                    this.props.editContext.mode === CreateTask.editMode.add ? \n                        <h4 className=\"modal-title\" id=\"myModalLabel\">New Problem</h4> :\n                        <h4 className=\"modal-title\" id=\"myModalLabel\">Edit Problem</h4>\n                }\n            </div>\n        )\n    }\n});\n\nInstForm.Body = React.createClass({\n    propTypes: {\n        editContext: React.PropTypes.object.isRequired\n    },\n    getInitialState: function() {\n        return {\n            text: this.props.editContext.inst ? this.props.editContext.inst.text : '',\n            next: this.props.editContext.inst ? this.props.editContext.inst.next : ''\n        }\n    },\n    componentWillReceiveProps: function(nextProps) {\n        if(nextProps.editContext) {\n            this.setState({\n                text: nextProps.editContext.inst ? nextProps.editContext.inst.text : '',\n                next: nextProps.editContext.inst ? nextProps.editContext.inst.next : ''\n            });\n        }\n    },\n    onChange: function(event) {\n        if(event.target.id == 'instText')\n            this.setState({text: event.target.value});\n        else if(event.target.id == 'instNext')\n            this.setState({next: event.target.value});\n    },\n    render: function() {\n        return (\n            <div className=\"modal-body\">\n                <form>\n                    <div className=\"form-group\">\n                        <label htmlFor=\"instText\">Text</label>\n                        <textarea className=\"form-control\" id=\"instText\" ref=\"text\" rows=\"6\" value={this.state.text} onChange={this.onChange}/>\n                    </div>\n                    <div className=\"form-group\">\n                        <label htmlFor=\"instNext\">Next Label</label>\n                        <input className=\"form-control\" id=\"instNext\" ref=\"next\" maxLength=\"30\" value={this.state.next} onChange={this.onChange}/>\n                    </div>\n                </form>\n            </div>\n        )\n    }\n});\n\nInstForm.Footer = React.createClass({\n    propTypes: {\n        onSaveClick: React.PropTypes.func.isRequired\n    },\n    render: function() {\n        return (\n            <div className=\"modal-footer\">\n                <button type=\"button\" className=\"btn btn-default\" data-dismiss=\"modal\">Cancel</button>\n                <button type=\"button\" className=\"btn btn-primary\" onClick={this.props.onSaveClick}>Ok</button>\n            </div>\n        )\n    }\n});\n"]}